/home/yangheng/miniconda3/bin/python /home/yangheng/omnigenome/examples/benchmark/batch_rgb_benchmark.py
Version 0.9.12 of metric_visualizer is outdated. Version 0.9.13 was released Wednesday May 01, 2024.
2024-08-03 17:00:56.119872: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-08-03 17:00:56.119908: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-08-03 17:00:56.121153: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-08-03 17:00:56.128025: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-08-03 17:00:57.022109: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Some weights of RnaMsmForTokenPrediction were not initialized from the model checkpoint at multimolecule/rnamsm and are newly initialized: ['rnamsm.pooler.dense.bias', 'rnamsm.pooler.dense.weight', 'token_head.decoder.bias', 'token_head.decoder.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:01:01] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 17:01:02] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 17:01:02] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: RnaMsmModel
Tokenizer: RnaTokenizer(name_or_path='multimolecule/rnamsm', vocab_size=26, model_max_length=1024, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<cls>', 'eos_token': '<eos>', 'unk_token': '<unk>', 'sep_token': '<eos>', 'pad_token': '<pad>', 'cls_token': '<cls>', 'mask_token': '<mask>'}, clean_up_tokenization_spaces=True),  added_tokens_decoder={
	0: AddedToken("<pad>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("<cls>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("<eos>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("<unk>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("<mask>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
Device: cuda:1
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-RnaMsmModel.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 17:01:02] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:01:02] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:01:02] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:01:02] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f17c686c9d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f186e757160>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:01:02] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnamsm
Model Type: rnamsm
Model Architecture: ['RnaMsmForPreTraining']
Model Parameters: 95.920384 M
Model Config: RnaMsmConfig {
  "_name_or_path": "multimolecule/rnamsm",
  "architectures": [
    "RnaMsmForPreTraining"
  ],
  "attention_bias": true,
  "attention_dropout": 0.1,
  "attention_type": "standard",
  "bos_token_id": 1,
  "embed_positions_msa": true,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 768,
    "layer_norm_eps": 1e-12,
    "num_labels": 1,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "layer_type": "standard",
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 768,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 1024,
  "max_tokens_per_msa": 16384,
  "model_type": "rnamsm",
  "null_token_id": 5,
  "num_attention_heads": 12,
  "num_hidden_layers": 10,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 17:01:02] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:01:02] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 17:01:02] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 17:01:02] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 2926.83it/s]
[2024-08-03 17:01:02] (0.0.8alpha) {'avg': 131.14599483204134, 'max': 501, 'min': 59}
[2024-08-03 17:01:02] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:01:02] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 17:01:02] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 17:01:02] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 2647.28it/s]
[2024-08-03 17:01:02] (0.0.8alpha) {'avg': 136.0326086956522, 'max': 349, 'min': 56}
[2024-08-03 17:01:02] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 23.97it/s]
[2024-08-03 17:01:03] (0.0.8alpha) {'f1_score': 0.2795796407152035, 'matthews_corrcoef': 0.0431851401179834}
Epoch 1/10 Loss: 0.9932: 100%|████████████████| 194/194 [00:13<00:00, 14.75it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 70.78it/s]
[2024-08-03 17:01:18] (0.0.8alpha) {'f1_score': 0.5826816185283911, 'matthews_corrcoef': 0.13523574910136182}
Epoch 2/10 Loss: 0.9170: 100%|████████████████| 194/194 [00:13<00:00, 14.58it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 70.62it/s]
[2024-08-03 17:01:32] (0.0.8alpha) {'f1_score': 0.6287700236766435, 'matthews_corrcoef': 0.16557406501160027}
Epoch 3/10 Loss: 0.8811: 100%|████████████████| 194/194 [00:13<00:00, 14.57it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 71.29it/s]
[2024-08-03 17:01:47] (0.0.8alpha) {'f1_score': 0.6444555902944001, 'matthews_corrcoef': 0.18168373886668868}
Epoch 4/10 Loss: 0.8610: 100%|████████████████| 194/194 [00:13<00:00, 14.52it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 70.17it/s]
[2024-08-03 17:02:01] (0.0.8alpha) {'f1_score': 0.6578778160493267, 'matthews_corrcoef': 0.1945318970471309}
Epoch 5/10 Loss: 0.8493: 100%|████████████████| 194/194 [00:13<00:00, 14.52it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 70.94it/s]
[2024-08-03 17:02:16] (0.0.8alpha) {'f1_score': 0.6685134158224808, 'matthews_corrcoef': 0.2124669173725791}
Epoch 6/10 Loss: 0.8387: 100%|████████████████| 194/194 [00:13<00:00, 14.31it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 60.31it/s]
[2024-08-03 17:02:31] (0.0.8alpha) {'f1_score': 0.6756841163820225, 'matthews_corrcoef': 0.2119465397967271}
Epoch 7/10 Loss: 0.8300: 100%|████████████████| 194/194 [00:13<00:00, 14.48it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 70.90it/s]
[2024-08-03 17:02:45] (0.0.8alpha) {'f1_score': 0.676717194911795, 'matthews_corrcoef': 0.21578143621975704}
Epoch 8/10 Loss: 0.8222: 100%|████████████████| 194/194 [00:13<00:00, 14.44it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 71.10it/s]
[2024-08-03 17:03:00] (0.0.8alpha) {'f1_score': 0.6835959820035731, 'matthews_corrcoef': 0.22312237605807184}
Epoch 9/10 Loss: 0.8153: 100%|████████████████| 194/194 [00:13<00:00, 14.43it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 70.34it/s]
[2024-08-03 17:03:15] (0.0.8alpha) {'f1_score': 0.6871056212807427, 'matthews_corrcoef': 0.22549536847642135}
Epoch 10/10 Loss: 0.8105: 100%|███████████████| 194/194 [00:13<00:00, 14.59it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 75.21it/s]
[2024-08-03 17:03:29] (0.0.8alpha) {'f1_score': 0.6871969921413948, 'matthews_corrcoef': 0.2189711629748572}
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 76.43it/s]
[2024-08-03 17:03:30] (0.0.8alpha) {'f1_score': 0.6871969921413948, 'matthews_corrcoef': 0.2189711629748572}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:03:30] (0.0.8alpha) {'valid': [{'f1_score': 0.2795796407152035, 'matthews_corrcoef': 0.0431851401179834}, {'f1_score': 0.5826816185283911, 'matthews_corrcoef': 0.13523574910136182}], 'best_valid': {'f1_score': 0.6871969921413948, 'matthews_corrcoef': 0.2189711629748572}, 'test': [{'f1_score': 0.6871969921413948, 'matthews_corrcoef': 0.2189711629748572}]}

------------------------------------------------------------------- Raw Metric Records -------------------------------------------------------------------
╒═══════════════════╤═════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                           │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-Archive2 │ [0.6872] │  0.6872   │  0.6872  │   0   │   0   │ 0.6872 │ 0.6872 │
├───────────────────┼─────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-Archive2 │ [0.219]  │   0.219   │  0.219   │   0   │   0   │ 0.219  │ 0.219  │
╘═══════════════════╧═════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
----------------------------------------------------- https://github.com/yangheng95/metric_visualizer -----------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 17:03:31] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:03:31] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:03:31] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:03:31] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843d73820>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843d73790>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:03:31] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnamsm
Model Type: rnamsm
Model Architecture: ['RnaMsmForPreTraining']
Model Parameters: 95.920384 M
Model Config: RnaMsmConfig {
  "_name_or_path": "multimolecule/rnamsm",
  "architectures": [
    "RnaMsmForPreTraining"
  ],
  "attention_bias": true,
  "attention_dropout": 0.1,
  "attention_type": "standard",
  "bos_token_id": 1,
  "embed_positions_msa": true,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 768,
    "layer_norm_eps": 1e-12,
    "num_labels": 1,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "layer_type": "standard",
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 768,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 1024,
  "max_tokens_per_msa": 16384,
  "model_type": "rnamsm",
  "null_token_id": 5,
  "num_attention_heads": 12,
  "num_hidden_layers": 10,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 17:03:31] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:03:31] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 17:03:31] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 17:03:31] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:01<00:00, 3603.17it/s]
[2024-08-03 17:03:33] (0.0.8alpha) {'avg': 102.8957415565345, 'max': 501, 'min': 55}
[2024-08-03 17:03:33] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:03:33] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 17:03:33] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 17:03:33] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 3598.12it/s]
[2024-08-03 17:03:33] (0.0.8alpha) {'avg': 103.2012987012987, 'max': 488, 'min': 72}
[2024-08-03 17:03:33] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 70.30it/s]
[2024-08-03 17:03:34] (0.0.8alpha) {'f1_score': 0.8227614345665533, 'matthews_corrcoef': 0.29076591226877063}
Epoch 1/10 Loss: 0.7132: 100%|██████████████| 1022/1022 [01:10<00:00, 14.45it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 73.85it/s]
[2024-08-03 17:04:48] (0.0.8alpha) {'f1_score': 0.8534513157652146, 'matthews_corrcoef': 0.31330808005086597}
Epoch 2/10 Loss: 0.6934: 100%|██████████████| 1022/1022 [01:10<00:00, 14.49it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 74.70it/s]
[2024-08-03 17:06:01] (0.0.8alpha) {'f1_score': 0.8662842475690504, 'matthews_corrcoef': 0.3162948544740723}
Epoch 3/10 Loss: 0.6784: 100%|██████████████| 1022/1022 [01:10<00:00, 14.59it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 63.79it/s]
[2024-08-03 17:07:13] (0.0.8alpha) {'f1_score': 0.8805621019086298, 'matthews_corrcoef': 0.24284075583858622}
Epoch 4/10 Loss: 0.6658: 100%|██████████████| 1022/1022 [01:08<00:00, 14.84it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 79.15it/s]
[2024-08-03 17:08:25] (0.0.8alpha) {'f1_score': 0.8876749254392996, 'matthews_corrcoef': 0.25632555050665135}
Epoch 5/10 Loss: 0.6564: 100%|██████████████| 1022/1022 [01:08<00:00, 14.92it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 80.00it/s]
[2024-08-03 17:09:35] (0.0.8alpha) {'f1_score': 0.8942885843443028, 'matthews_corrcoef': 0.31758050352765643}
Epoch 6/10 Loss: 0.6497: 100%|██████████████| 1022/1022 [01:08<00:00, 14.98it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 79.58it/s]
[2024-08-03 17:10:46] (0.0.8alpha) {'f1_score': 0.9008401772626993, 'matthews_corrcoef': 0.2690117931833618}
Epoch 7/10 Loss: 0.6441: 100%|██████████████| 1022/1022 [01:08<00:00, 14.83it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 79.84it/s]
[2024-08-03 17:11:57] (0.0.8alpha) {'f1_score': 0.9061731189424909, 'matthews_corrcoef': 0.2567134000914257}
Epoch 8/10 Loss: 0.6401: 100%|██████████████| 1022/1022 [01:08<00:00, 14.94it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 79.17it/s]
[2024-08-03 17:13:08] (0.0.8alpha) {'f1_score': 0.9076087948934278, 'matthews_corrcoef': 0.27527911814706485}
Epoch 9/10 Loss: 0.6364: 100%|██████████████| 1022/1022 [01:08<00:00, 14.82it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 78.58it/s]
[2024-08-03 17:14:19] (0.0.8alpha) {'f1_score': 0.910563601652519, 'matthews_corrcoef': 0.2855059387423674}
Epoch 10/10 Loss: 0.6326: 100%|█████████████| 1022/1022 [01:10<00:00, 14.54it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 78.52it/s]
[2024-08-03 17:15:32] (0.0.8alpha) {'f1_score': 0.9114954695264629, 'matthews_corrcoef': 0.27204605513332103}
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 78.79it/s]
[2024-08-03 17:15:34] (0.0.8alpha) {'f1_score': 0.9114954695264629, 'matthews_corrcoef': 0.27204605513332103}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:15:34] (0.0.8alpha) {'valid': [{'f1_score': 0.8227614345665533, 'matthews_corrcoef': 0.29076591226877063}, {'f1_score': 0.8534513157652146, 'matthews_corrcoef': 0.31330808005086597}], 'best_valid': {'f1_score': 0.9114954695264629, 'matthews_corrcoef': 0.27204605513332103}, 'test': [{'f1_score': 0.9114954695264629, 'matthews_corrcoef': 0.27204605513332103}]}

--------------------------------------------------------------------- Raw Metric Records ---------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                              │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-Archive2    │ [0.6872] │  0.6872   │  0.6872  │   0   │   0   │ 0.6872 │ 0.6872 │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-rnastralign │ [0.9115] │  0.9115   │  0.9115  │   0   │   0   │ 0.9115 │ 0.9115 │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-Archive2    │ [0.219]  │   0.219   │  0.219   │   0   │   0   │ 0.219  │ 0.219  │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-rnastralign │ [0.272]  │   0.272   │  0.272   │   0   │   0   │ 0.272  │ 0.272  │
╘═══════════════════╧════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 17:15:35] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:15:35] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:15:35] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:15:35] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843dd3dc0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843dd3af0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:15:35] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnamsm
Model Type: rnamsm
Model Architecture: ['RnaMsmForPreTraining']
Model Parameters: 95.920384 M
Model Config: RnaMsmConfig {
  "_name_or_path": "multimolecule/rnamsm",
  "architectures": [
    "RnaMsmForPreTraining"
  ],
  "attention_bias": true,
  "attention_dropout": 0.1,
  "attention_type": "standard",
  "bos_token_id": 1,
  "embed_positions_msa": true,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 768,
    "layer_norm_eps": 1e-12,
    "num_labels": 1,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "layer_type": "standard",
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 768,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 1024,
  "max_tokens_per_msa": 16384,
  "model_type": "rnamsm",
  "null_token_id": 5,
  "num_attention_heads": 12,
  "num_hidden_layers": 10,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 17:15:35] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:15:35] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 17:15:35] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 17:15:35] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████| 11304/11304 [00:04<00:00, 2790.47it/s]
[2024-08-03 17:15:41] (0.0.8alpha) {'avg': 134.37039985845718, 'max': 512, 'min': 13}
[2024-08-03 17:15:41] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:15:41] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 17:15:41] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 17:15:41] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 3043.16it/s]
[2024-08-03 17:15:42] (0.0.8alpha) {'avg': 132.0485668789809, 'max': 512, 'min': 19}
[2024-08-03 17:15:42] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 79.44it/s]
[2024-08-03 17:15:46] (0.0.8alpha) {'f1_score': 0.48571652256168746, 'matthews_corrcoef': 0.015954725646627612}
Epoch 1/10 Loss: 0.9243: 100%|██████████████| 2826/2826 [03:13<00:00, 14.62it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 78.51it/s]
[2024-08-03 17:19:04] (0.0.8alpha) {'f1_score': 0.543218843032594, 'matthews_corrcoef': 0.10107897556770887}
Epoch 2/10 Loss: 0.8996: 100%|██████████████| 2826/2826 [03:13<00:00, 14.62it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 78.44it/s]
[2024-08-03 17:22:22] (0.0.8alpha) {'f1_score': 0.5557329401479447, 'matthews_corrcoef': 0.1246081676591947}
Epoch 3/10 Loss: 0.8871: 100%|██████████████| 2826/2826 [03:13<00:00, 14.62it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 78.54it/s]
[2024-08-03 17:25:41] (0.0.8alpha) {'f1_score': 0.5935123754599558, 'matthews_corrcoef': 0.11736560182195334}
Epoch 4/10 Loss: 0.8766: 100%|██████████████| 2826/2826 [03:12<00:00, 14.71it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 79.72it/s]
[2024-08-03 17:28:58] (0.0.8alpha) {'f1_score': 0.6086223311201185, 'matthews_corrcoef': 0.11859575298775776}
Epoch 5/10 Loss: 0.8676: 100%|██████████████| 2826/2826 [03:08<00:00, 14.98it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 79.94it/s]
[2024-08-03 17:32:11] (0.0.8alpha) {'f1_score': 0.6003794491376626, 'matthews_corrcoef': 0.1340209974723272}
Epoch 6/10 Loss: 0.8599: 100%|██████████████| 2826/2826 [03:08<00:00, 14.95it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 79.91it/s]
[2024-08-03 17:35:25] (0.0.8alpha) {'f1_score': 0.6148202867784476, 'matthews_corrcoef': 0.13810518043887318}
Epoch 7/10 Loss: 0.8530: 100%|██████████████| 2826/2826 [03:10<00:00, 14.82it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 79.69it/s]
[2024-08-03 17:38:40] (0.0.8alpha) {'f1_score': 0.6234657201338591, 'matthews_corrcoef': 0.14188101745797702}
Epoch 8/10 Loss: 0.8454: 100%|██████████████| 2826/2826 [03:10<00:00, 14.87it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 80.22it/s]
[2024-08-03 17:41:55] (0.0.8alpha) {'f1_score': 0.6251545665083624, 'matthews_corrcoef': 0.14260169265698394}
Epoch 9/10 Loss: 0.8396: 100%|██████████████| 2826/2826 [03:08<00:00, 15.01it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 80.09it/s]
[2024-08-03 17:45:08] (0.0.8alpha) {'f1_score': 0.6380805128760605, 'matthews_corrcoef': 0.1454362649803521}
Epoch 10/10 Loss: 0.8334: 100%|█████████████| 2826/2826 [03:08<00:00, 14.97it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 80.11it/s]
[2024-08-03 17:48:22] (0.0.8alpha) {'f1_score': 0.6444399548925235, 'matthews_corrcoef': 0.1422329834309813}
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 80.43it/s]
[2024-08-03 17:48:27] (0.0.8alpha) {'f1_score': 0.6444399548925235, 'matthews_corrcoef': 0.1422329834309813}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:48:27] (0.0.8alpha) {'valid': [{'f1_score': 0.48571652256168746, 'matthews_corrcoef': 0.015954725646627612}, {'f1_score': 0.543218843032594, 'matthews_corrcoef': 0.10107897556770887}], 'best_valid': {'f1_score': 0.6444399548925235, 'matthews_corrcoef': 0.1422329834309813}, 'test': [{'f1_score': 0.6444399548925235, 'matthews_corrcoef': 0.1422329834309813}]}

--------------------------------------------------------------------- Raw Metric Records ---------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                              │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-Archive2    │ [0.6872] │  0.6872   │  0.6872  │   0   │   0   │ 0.6872 │ 0.6872 │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-rnastralign │ [0.9115] │  0.9115   │  0.9115  │   0   │   0   │ 0.9115 │ 0.9115 │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-bpRNA       │ [0.6444] │  0.6444   │  0.6444  │   0   │   0   │ 0.6444 │ 0.6444 │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-Archive2    │ [0.219]  │   0.219   │  0.219   │   0   │   0   │ 0.219  │ 0.219  │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-rnastralign │ [0.272]  │   0.272   │  0.272   │   0   │   0   │ 0.272  │ 0.272  │
├───────────────────┼────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaMsmModel-RNA-SSP-bpRNA       │ [0.1422] │  0.1422   │  0.1422  │   0   │   0   │ 0.1422 │ 0.1422 │
╘═══════════════════╧════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------

Some weights of RnaFmForTokenPrediction were not initialized from the model checkpoint at multimolecule/rnafm and are newly initialized: ['rnafm.pooler.dense.bias', 'rnafm.pooler.dense.weight', 'token_head.decoder.bias', 'token_head.decoder.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:48:31] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 17:48:31] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 17:48:31] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: RnaFmModel
Tokenizer: RnaTokenizer(name_or_path='multimolecule/rnafm', vocab_size=26, model_max_length=1024, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<cls>', 'eos_token': '<eos>', 'unk_token': '<unk>', 'sep_token': '<eos>', 'pad_token': '<pad>', 'cls_token': '<cls>', 'mask_token': '<mask>'}, clean_up_tokenization_spaces=True),  added_tokens_decoder={
	0: AddedToken("<pad>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("<cls>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("<eos>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("<unk>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("<mask>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
Device: cuda:1
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-RnaFmModel.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 17:48:31] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:48:31] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:48:31] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:48:31] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f17c686c9d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f17c7812160>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:48:31] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnafm
Model Type: rnafm
Model Architecture: ['RnaFmForPreTraining']
Model Parameters: 99.52064 M
Model Config: RnaFmConfig {
  "_name_or_path": "multimolecule/rnafm",
  "architectures": [
    "RnaFmForPreTraining"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 1,
  "codon": true,
  "emb_layer_norm_before": true,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 640,
    "layer_norm_eps": 1e-12,
    "num_labels": 1,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.1,
  "hidden_size": 640,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 5120,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 640,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 1026,
  "model_type": "rnafm",
  "null_token_id": 5,
  "num_attention_heads": 20,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "token_dropout": false,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 17:48:31] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:48:31] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 17:48:31] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 17:48:31] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 2735.87it/s]
[2024-08-03 17:48:31] (0.0.8alpha) {'avg': 131.14599483204134, 'max': 501, 'min': 59}
[2024-08-03 17:48:31] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:48:31] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 17:48:31] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 17:48:31] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 2874.82it/s]
[2024-08-03 17:48:31] (0.0.8alpha) {'avg': 136.0326086956522, 'max': 349, 'min': 56}
[2024-08-03 17:48:31] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 88.14it/s]
[2024-08-03 17:48:32] (0.0.8alpha) {'f1_score': 0.2906536786070952, 'matthews_corrcoef': 0.036770510575087144}
Epoch 1/10 Loss: 0.8872: 100%|████████████████| 194/194 [00:12<00:00, 15.87it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 92.76it/s]
[2024-08-03 17:48:45] (0.0.8alpha) {'f1_score': 0.7423947321645764, 'matthews_corrcoef': 0.26415988747524494}
Epoch 2/10 Loss: 0.7345: 100%|████████████████| 194/194 [00:12<00:00, 15.95it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.87it/s]
[2024-08-03 17:48:58] (0.0.8alpha) {'f1_score': 0.7700783671894885, 'matthews_corrcoef': 0.28757429328282935}
Epoch 3/10 Loss: 0.7103: 100%|████████████████| 194/194 [00:12<00:00, 15.88it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.68it/s]
[2024-08-03 17:49:12] (0.0.8alpha) {'f1_score': 0.7849617216310296, 'matthews_corrcoef': 0.2999118887252862}
Epoch 4/10 Loss: 0.7004: 100%|████████████████| 194/194 [00:12<00:00, 15.90it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.89it/s]
[2024-08-03 17:49:25] (0.0.8alpha) {'f1_score': 0.8004628505426391, 'matthews_corrcoef': 0.3176096980124165}
Epoch 5/10 Loss: 0.6902: 100%|████████████████| 194/194 [00:12<00:00, 15.88it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 94.69it/s]
[2024-08-03 17:49:38] (0.0.8alpha) {'f1_score': 0.803145591927608, 'matthews_corrcoef': 0.3180711829796034}
Epoch 6/10 Loss: 0.6826: 100%|████████████████| 194/194 [00:12<00:00, 16.03it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 92.81it/s]
[2024-08-03 17:49:52] (0.0.8alpha) {'f1_score': 0.8128574039704223, 'matthews_corrcoef': 0.32596698623244613}
Epoch 7/10 Loss: 0.6770: 100%|████████████████| 194/194 [00:12<00:00, 16.00it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 92.75it/s]
[2024-08-03 17:50:05] (0.0.8alpha) {'f1_score': 0.8165332444139476, 'matthews_corrcoef': 0.32731988416293467}
Epoch 8/10 Loss: 0.6683: 100%|████████████████| 194/194 [00:12<00:00, 15.91it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.29it/s]
[2024-08-03 17:50:18] (0.0.8alpha) {'f1_score': 0.8182454427017906, 'matthews_corrcoef': 0.32849375093646027}
Epoch 9/10 Loss: 0.6659: 100%|████████████████| 194/194 [00:12<00:00, 15.89it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.29it/s]
[2024-08-03 17:50:32] (0.0.8alpha) {'f1_score': 0.8230419615431056, 'matthews_corrcoef': 0.33175810781507453}
Epoch 10/10 Loss: 0.6609: 100%|███████████████| 194/194 [00:12<00:00, 15.89it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.54it/s]
[2024-08-03 17:50:45] (0.0.8alpha) {'f1_score': 0.8254672356009304, 'matthews_corrcoef': 0.335050350923705}
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 96.55it/s]
[2024-08-03 17:50:46] (0.0.8alpha) {'f1_score': 0.8254672356009304, 'matthews_corrcoef': 0.335050350923705}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:50:47] (0.0.8alpha) {'valid': [{'f1_score': 0.2906536786070952, 'matthews_corrcoef': 0.036770510575087144}, {'f1_score': 0.7423947321645764, 'matthews_corrcoef': 0.26415988747524494}], 'best_valid': {'f1_score': 0.8254672356009304, 'matthews_corrcoef': 0.335050350923705}, 'test': [{'f1_score': 0.8254672356009304, 'matthews_corrcoef': 0.335050350923705}]}

------------------------------------------------------------------- Raw Metric Records -------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                          │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-Archive2 │ [0.8255] │  0.8255   │  0.8255  │   0   │   0   │ 0.8255 │ 0.8255 │
├───────────────────┼────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-Archive2 │ [0.3351] │  0.3351   │  0.3351  │   0   │   0   │ 0.3351 │ 0.3351 │
╘═══════════════════╧════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 17:50:47] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:50:47] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:50:47] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:50:47] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f183dc435e0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f183dc43670>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:50:47] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnafm
Model Type: rnafm
Model Architecture: ['RnaFmForPreTraining']
Model Parameters: 99.52064 M
Model Config: RnaFmConfig {
  "_name_or_path": "multimolecule/rnafm",
  "architectures": [
    "RnaFmForPreTraining"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 1,
  "codon": true,
  "emb_layer_norm_before": true,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 640,
    "layer_norm_eps": 1e-12,
    "num_labels": 1,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.1,
  "hidden_size": 640,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 5120,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 640,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 1026,
  "model_type": "rnafm",
  "null_token_id": 5,
  "num_attention_heads": 20,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "token_dropout": false,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 17:50:47] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:50:47] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 17:50:47] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 17:50:47] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:01<00:00, 3787.58it/s]
[2024-08-03 17:50:49] (0.0.8alpha) {'avg': 102.8957415565345, 'max': 501, 'min': 55}
[2024-08-03 17:50:49] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:50:49] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 17:50:49] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 17:50:49] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 3771.69it/s]
[2024-08-03 17:50:49] (0.0.8alpha) {'avg': 103.2012987012987, 'max': 488, 'min': 72}
[2024-08-03 17:50:49] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.61it/s]
[2024-08-03 17:50:51] (0.0.8alpha) {'f1_score': 0.9239505288446545, 'matthews_corrcoef': 0.36947569227820015}
Epoch 1/10 Loss: 0.6080: 100%|██████████████| 1022/1022 [01:05<00:00, 15.54it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.78it/s]
[2024-08-03 17:51:59] (0.0.8alpha) {'f1_score': 0.9411204440960715, 'matthews_corrcoef': 0.3807332798297258}
Epoch 2/10 Loss: 0.5998: 100%|██████████████| 1022/1022 [01:05<00:00, 15.50it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.63it/s]
[2024-08-03 17:53:07] (0.0.8alpha) {'f1_score': 0.94405244953354, 'matthews_corrcoef': 0.3767621751143706}
Epoch 3/10 Loss: 0.5952: 100%|██████████████| 1022/1022 [01:05<00:00, 15.51it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.65it/s]
[2024-08-03 17:54:15] (0.0.8alpha) {'f1_score': 0.948472903619447, 'matthews_corrcoef': 0.364897740019452}
Epoch 4/10 Loss: 0.5913: 100%|██████████████| 1022/1022 [01:05<00:00, 15.50it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.61it/s]
[2024-08-03 17:55:24] (0.0.8alpha) {'f1_score': 0.9470472894406822, 'matthews_corrcoef': 0.3827165569620904}
Epoch 5/10 Loss: 0.5878: 100%|██████████████| 1022/1022 [01:05<00:00, 15.59it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.80it/s]
[2024-08-03 17:56:31] (0.0.8alpha) {'f1_score': 0.9537194652027945, 'matthews_corrcoef': 0.39360942300160545}
Epoch 6/10 Loss: 0.5857: 100%|██████████████| 1022/1022 [01:06<00:00, 15.44it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.11it/s]
[2024-08-03 17:57:39] (0.0.8alpha) {'f1_score': 0.9535312917736377, 'matthews_corrcoef': 0.3934799208896439}
Epoch 7/10 Loss: 0.5834: 100%|██████████████| 1022/1022 [01:05<00:00, 15.57it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.67it/s]
[2024-08-03 17:58:47] (0.0.8alpha) {'f1_score': 0.9567600199748205, 'matthews_corrcoef': 0.3896029014322405}
Epoch 8/10 Loss: 0.5815: 100%|██████████████| 1022/1022 [01:03<00:00, 16.00it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.70it/s]
[2024-08-03 17:59:53] (0.0.8alpha) {'f1_score': 0.9569482349655631, 'matthews_corrcoef': 0.3937762638889666}
Epoch 9/10 Loss: 0.5788: 100%|██████████████| 1022/1022 [01:04<00:00, 15.95it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.70it/s]
[2024-08-03 18:00:59] (0.0.8alpha) {'f1_score': 0.9558901512426491, 'matthews_corrcoef': 0.39274939478201015}
Epoch 10/10 Loss: 0.5767: 100%|█████████████| 1022/1022 [01:05<00:00, 15.64it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 77.57it/s]
[2024-08-03 18:02:06] (0.0.8alpha) {'f1_score': 0.9607467757118999, 'matthews_corrcoef': 0.400887213737675}
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 78.13it/s]
[2024-08-03 18:02:09] (0.0.8alpha) {'f1_score': 0.9607467757118999, 'matthews_corrcoef': 0.400887213737675}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:02:09] (0.0.8alpha) {'valid': [{'f1_score': 0.9239505288446545, 'matthews_corrcoef': 0.36947569227820015}, {'f1_score': 0.9411204440960715, 'matthews_corrcoef': 0.3807332798297258}], 'best_valid': {'f1_score': 0.9607467757118999, 'matthews_corrcoef': 0.400887213737675}, 'test': [{'f1_score': 0.9607467757118999, 'matthews_corrcoef': 0.400887213737675}]}

-------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                             │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-Archive2    │ [0.8255] │  0.8255   │  0.8255  │   0   │   0   │ 0.8255 │ 0.8255 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-rnastralign │ [0.9607] │  0.9607   │  0.9607  │   0   │   0   │ 0.9607 │ 0.9607 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-Archive2    │ [0.3351] │  0.3351   │  0.3351  │   0   │   0   │ 0.3351 │ 0.3351 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-rnastralign │ [0.4009] │  0.4009   │  0.4009  │   0   │   0   │ 0.4009 │ 0.4009 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 18:02:09] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:02:09] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:02:09] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:02:09] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f183db0d700>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f183db0d790>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:02:09] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnafm
Model Type: rnafm
Model Architecture: ['RnaFmForPreTraining']
Model Parameters: 99.52064 M
Model Config: RnaFmConfig {
  "_name_or_path": "multimolecule/rnafm",
  "architectures": [
    "RnaFmForPreTraining"
  ],
  "attention_dropout": 0.1,
  "bos_token_id": 1,
  "codon": true,
  "emb_layer_norm_before": true,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 640,
    "layer_norm_eps": 1e-12,
    "num_labels": 1,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.1,
  "hidden_size": 640,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 5120,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 640,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 1026,
  "model_type": "rnafm",
  "null_token_id": 5,
  "num_attention_heads": 20,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "token_dropout": false,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 18:02:09] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:02:09] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 18:02:09] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 18:02:09] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████| 11304/11304 [00:03<00:00, 2975.45it/s]
[2024-08-03 18:02:15] (0.0.8alpha) {'avg': 134.37039985845718, 'max': 512, 'min': 13}
[2024-08-03 18:02:15] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:02:16] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 18:02:16] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 18:02:16] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 3036.54it/s]
[2024-08-03 18:02:16] (0.0.8alpha) {'avg': 132.0485668789809, 'max': 512, 'min': 19}
[2024-08-03 18:02:16] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.56it/s]
[2024-08-03 18:02:21] (0.0.8alpha) {'f1_score': 0.5472876840822691, 'matthews_corrcoef': 0.0657106581366438}
Epoch 1/10 Loss: 0.8533: 100%|██████████████| 2826/2826 [03:01<00:00, 15.59it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.58it/s]
[2024-08-03 18:05:27] (0.0.8alpha) {'f1_score': 0.6898155206613598, 'matthews_corrcoef': 0.19046274543114453}
Epoch 2/10 Loss: 0.8128: 100%|██████████████| 2826/2826 [03:01<00:00, 15.57it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.63it/s]
[2024-08-03 18:08:34] (0.0.8alpha) {'f1_score': 0.7129875014544443, 'matthews_corrcoef': 0.21668201130077216}
Epoch 3/10 Loss: 0.7920: 100%|██████████████| 2826/2826 [03:01<00:00, 15.56it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.64it/s]
[2024-08-03 18:11:41] (0.0.8alpha) {'f1_score': 0.7338630721709242, 'matthews_corrcoef': 0.2169910417914645}
Epoch 4/10 Loss: 0.7754: 100%|██████████████| 2826/2826 [03:02<00:00, 15.48it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 67.03it/s]
[2024-08-03 18:14:49] (0.0.8alpha) {'f1_score': 0.7443779653431557, 'matthews_corrcoef': 0.22769351556576473}
Epoch 5/10 Loss: 0.7623: 100%|██████████████| 2826/2826 [03:08<00:00, 15.02it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.74it/s]
[2024-08-03 18:18:03] (0.0.8alpha) {'f1_score': 0.7530681212285106, 'matthews_corrcoef': 0.23030006783842033}
Epoch 6/10 Loss: 0.7511: 100%|██████████████| 2826/2826 [03:07<00:00, 15.03it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.79it/s]
[2024-08-03 18:21:16] (0.0.8alpha) {'f1_score': 0.7611614998722174, 'matthews_corrcoef': 0.23195555354068714}
Epoch 7/10 Loss: 0.7420: 100%|██████████████| 2826/2826 [03:07<00:00, 15.04it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.68it/s]
[2024-08-03 18:24:30] (0.0.8alpha) {'f1_score': 0.7682533403164888, 'matthews_corrcoef': 0.24281596527897473}
Epoch 8/10 Loss: 0.7330: 100%|██████████████| 2826/2826 [03:08<00:00, 15.02it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.68it/s]
[2024-08-03 18:27:43] (0.0.8alpha) {'f1_score': 0.7715597217251607, 'matthews_corrcoef': 0.24644109086085825}
Epoch 9/10 Loss: 0.7250: 100%|██████████████| 2826/2826 [03:07<00:00, 15.03it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.71it/s]
[2024-08-03 18:30:56] (0.0.8alpha) {'f1_score': 0.7771269865441992, 'matthews_corrcoef': 0.24948371076476442}
Epoch 10/10 Loss: 0.7178: 100%|█████████████| 2826/2826 [03:06<00:00, 15.13it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.69it/s]
[2024-08-03 18:34:09] (0.0.8alpha) {'f1_score': 0.7816126381264822, 'matthews_corrcoef': 0.2543577829906311}
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 73.96it/s]
[2024-08-03 18:34:14] (0.0.8alpha) {'f1_score': 0.7816126381264822, 'matthews_corrcoef': 0.2543577829906311}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:34:14] (0.0.8alpha) {'valid': [{'f1_score': 0.5472876840822691, 'matthews_corrcoef': 0.0657106581366438}, {'f1_score': 0.6898155206613598, 'matthews_corrcoef': 0.19046274543114453}], 'best_valid': {'f1_score': 0.7816126381264822, 'matthews_corrcoef': 0.2543577829906311}, 'test': [{'f1_score': 0.7816126381264822, 'matthews_corrcoef': 0.2543577829906311}]}

-------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                             │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-Archive2    │ [0.8255] │  0.8255   │  0.8255  │   0   │   0   │ 0.8255 │ 0.8255 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-rnastralign │ [0.9607] │  0.9607   │  0.9607  │   0   │   0   │ 0.9607 │ 0.9607 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-bpRNA       │ [0.7816] │  0.7816   │  0.7816  │   0   │   0   │ 0.7816 │ 0.7816 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-Archive2    │ [0.3351] │  0.3351   │  0.3351  │   0   │   0   │ 0.3351 │ 0.3351 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-rnastralign │ [0.4009] │  0.4009   │  0.4009  │   0   │   0   │ 0.4009 │ 0.4009 │
├───────────────────┼───────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaFmModel-RNA-SSP-bpRNA       │ [0.2544] │  0.2544   │  0.2544  │   0   │   0   │ 0.2544 │ 0.2544 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------

Some weights of RnaBertForTokenPrediction were not initialized from the model checkpoint at multimolecule/rnabert and are newly initialized: ['token_head.decoder.bias', 'token_head.decoder.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 18:34:18] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 18:34:18] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 18:34:18] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: RnaBertModel
Tokenizer: RnaTokenizer(name_or_path='multimolecule/rnabert', vocab_size=26, model_max_length=440, is_fast=False, padding_side='right', truncation_side='right', special_tokens={'bos_token': '<cls>', 'eos_token': '<eos>', 'unk_token': '<unk>', 'sep_token': '<eos>', 'pad_token': '<pad>', 'cls_token': '<cls>', 'mask_token': '<mask>'}, clean_up_tokenization_spaces=True),  added_tokens_decoder={
	0: AddedToken("<pad>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	1: AddedToken("<cls>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	2: AddedToken("<eos>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	3: AddedToken("<unk>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
	4: AddedToken("<mask>", rstrip=False, lstrip=False, single_word=False, normalized=False, special=True),
}
Device: cuda:1
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-RnaBertModel.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 18:34:18] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:34:18] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:34:18] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:34:18] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f17c68670d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f183dc43f70>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:34:18] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnabert
Model Type: rnabert
Model Architecture: ['RnaBertForPreTraining']
Model Parameters: 0.48084 M
Model Config: RnaBertConfig {
  "_name_or_path": "multimolecule/rnabert",
  "architectures": [
    "RnaBertForPreTraining"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 120,
    "layer_norm_eps": 1e-12,
    "num_labels": 2,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.0,
  "hidden_size": 120,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 40,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 120,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 440,
  "model_type": "rnabert",
  "null_token_id": 5,
  "num_attention_heads": 12,
  "num_hidden_layers": 6,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "ss_vocab_size": 8,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 18:34:18] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
[2024-08-03 18:34:18] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 18:34:18] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 18:34:18] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 2620.18it/s]
[2024-08-03 18:34:18] (0.0.8alpha) {'avg': 130.78552971576227, 'max': 440, 'min': 59}
[2024-08-03 18:34:18] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
[2024-08-03 18:34:18] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 18:34:18] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 18:34:18] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 2859.21it/s]
[2024-08-03 18:34:18] (0.0.8alpha) {'avg': 136.0326086956522, 'max': 349, 'min': 56}
[2024-08-03 18:34:18] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 114.38it/s]
[2024-08-03 18:34:18] (0.0.8alpha) {'f1_score': 0.24196286706733913, 'matthews_corrcoef': 0.012539564597105441}
Epoch 1/10 Loss: 1.0931: 100%|████████████████| 194/194 [00:10<00:00, 19.00it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 115.65it/s]
[2024-08-03 18:34:29] (0.0.8alpha) {'f1_score': 0.24660528806767776, 'matthews_corrcoef': 0.011343784244664708}
Epoch 2/10 Loss: 1.0808: 100%|████████████████| 194/194 [00:10<00:00, 19.07it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 116.11it/s]
[2024-08-03 18:34:39] (0.0.8alpha) {'f1_score': 0.21036856127886325, 'matthews_corrcoef': 0.0}
Epoch 3/10 Loss: 1.0718: 100%|████████████████| 194/194 [00:10<00:00, 18.88it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 137.27it/s]
[2024-08-03 18:34:50] (0.0.8alpha) {'f1_score': 0.21036856127886325, 'matthews_corrcoef': 0.0}
Epoch 4/10 Loss: 1.0633: 100%|████████████████| 194/194 [00:10<00:00, 19.25it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 115.55it/s]
[2024-08-03 18:35:00] (0.0.8alpha) {'f1_score': 0.21092837679544207, 'matthews_corrcoef': 0.0009437387911207686}
Early stopping at epoch 4.
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 141.38it/s]
[2024-08-03 18:35:00] (0.0.8alpha) {'f1_score': 0.24660528806767776, 'matthews_corrcoef': 0.011343784244664708}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:35:00] (0.0.8alpha) {'valid': [{'f1_score': 0.24196286706733913, 'matthews_corrcoef': 0.012539564597105441}, {'f1_score': 0.24660528806767776, 'matthews_corrcoef': 0.011343784244664708}], 'best_valid': {'f1_score': 0.24660528806767776, 'matthews_corrcoef': 0.011343784244664708}, 'test': [{'f1_score': 0.24660528806767776, 'matthews_corrcoef': 0.011343784244664708}]}

-------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------
╒═══════════════════╤══════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                            │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪══════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-Archive2 │ [0.2466] │  0.2466   │  0.2466  │   0   │   0   │ 0.2466 │ 0.2466 │
├───────────────────┼──────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-Archive2 │ [0.0113] │  0.0113   │  0.0113  │   0   │   0   │ 0.0113 │ 0.0113 │
╘═══════════════════╧══════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
----------------------------------------------------- https://github.com/yangheng95/metric_visualizer -----------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 18:35:00] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:35:00] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:35:00] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:35:00] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843d62700>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843d62550>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:35:00] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnabert
Model Type: rnabert
Model Architecture: ['RnaBertForPreTraining']
Model Parameters: 0.48084 M
Model Config: RnaBertConfig {
  "_name_or_path": "multimolecule/rnabert",
  "architectures": [
    "RnaBertForPreTraining"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 120,
    "layer_norm_eps": 1e-12,
    "num_labels": 2,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.0,
  "hidden_size": 120,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 40,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 120,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 440,
  "model_type": "rnabert",
  "null_token_id": 5,
  "num_attention_heads": 12,
  "num_hidden_layers": 6,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "ss_vocab_size": 8,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 18:35:00] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
[2024-08-03 18:35:00] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 18:35:00] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 18:35:00] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:01<00:00, 3779.98it/s]
[2024-08-03 18:35:02] (0.0.8alpha) {'avg': 102.84018600097895, 'max': 440, 'min': 55}
[2024-08-03 18:35:02] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
[2024-08-03 18:35:02] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 18:35:02] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 18:35:02] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 3726.06it/s]
[2024-08-03 18:35:02] (0.0.8alpha) {'avg': 103.09740259740259, 'max': 440, 'min': 72}
[2024-08-03 18:35:02] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 142.87it/s]
[2024-08-03 18:35:03] (0.0.8alpha) {'f1_score': 0.24496771277683818, 'matthews_corrcoef': 0.010644383375430057}
Epoch 1/10 Loss: 1.0415: 100%|██████████████| 1022/1022 [00:55<00:00, 18.38it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 130.05it/s]
[2024-08-03 18:36:00] (0.0.8alpha) {'f1_score': 0.5133306730381405, 'matthews_corrcoef': 0.124411346378853}
Epoch 2/10 Loss: 0.9304: 100%|██████████████| 1022/1022 [00:57<00:00, 17.82it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 129.69it/s]
[2024-08-03 18:36:58] (0.0.8alpha) {'f1_score': 0.7472896950050693, 'matthews_corrcoef': 0.20306816262105942}
Epoch 3/10 Loss: 0.8196: 100%|██████████████| 1022/1022 [00:57<00:00, 17.79it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 129.81it/s]
[2024-08-03 18:37:57] (0.0.8alpha) {'f1_score': 0.7874548233272769, 'matthews_corrcoef': 0.22636011615301774}
Epoch 4/10 Loss: 0.7651: 100%|██████████████| 1022/1022 [00:57<00:00, 17.74it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 129.63it/s]
[2024-08-03 18:38:55] (0.0.8alpha) {'f1_score': 0.8080611972611361, 'matthews_corrcoef': 0.23604016209147727}
Epoch 5/10 Loss: 0.7367: 100%|██████████████| 1022/1022 [00:57<00:00, 17.77it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 129.20it/s]
[2024-08-03 18:39:54] (0.0.8alpha) {'f1_score': 0.8178070993036332, 'matthews_corrcoef': 0.23615748187620036}
Epoch 6/10 Loss: 0.7215: 100%|██████████████| 1022/1022 [00:57<00:00, 17.78it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 129.78it/s]
[2024-08-03 18:40:52] (0.0.8alpha) {'f1_score': 0.8233699339779363, 'matthews_corrcoef': 0.23892088260986047}
Epoch 7/10 Loss: 0.7131: 100%|██████████████| 1022/1022 [00:57<00:00, 17.82it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 130.12it/s]
[2024-08-03 18:41:50] (0.0.8alpha) {'f1_score': 0.8269919385108655, 'matthews_corrcoef': 0.23793156718967157}
Epoch 8/10 Loss: 0.7076: 100%|██████████████| 1022/1022 [00:57<00:00, 17.79it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 128.86it/s]
[2024-08-03 18:42:49] (0.0.8alpha) {'f1_score': 0.8313979466484577, 'matthews_corrcoef': 0.2391054655445457}
Epoch 9/10 Loss: 0.7024: 100%|██████████████| 1022/1022 [00:57<00:00, 17.76it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 130.13it/s]
[2024-08-03 18:43:47] (0.0.8alpha) {'f1_score': 0.8340196579882946, 'matthews_corrcoef': 0.23894477291920385}
Epoch 10/10 Loss: 0.6982: 100%|█████████████| 1022/1022 [00:56<00:00, 18.11it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 135.41it/s]
[2024-08-03 18:44:45] (0.0.8alpha) {'f1_score': 0.8368480996429617, 'matthews_corrcoef': 0.24063868463198887}
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 136.99it/s]
[2024-08-03 18:44:46] (0.0.8alpha) {'f1_score': 0.8368480996429617, 'matthews_corrcoef': 0.24063868463198887}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:44:46] (0.0.8alpha) {'valid': [{'f1_score': 0.24496771277683818, 'matthews_corrcoef': 0.010644383375430057}, {'f1_score': 0.5133306730381405, 'matthews_corrcoef': 0.124411346378853}], 'best_valid': {'f1_score': 0.8368480996429617, 'matthews_corrcoef': 0.24063868463198887}, 'test': [{'f1_score': 0.8368480996429617, 'matthews_corrcoef': 0.24063868463198887}]}

--------------------------------------------------------------------- Raw Metric Records ---------------------------------------------------------------------
╒═══════════════════╤═════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                               │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-Archive2    │ [0.2466] │  0.2466   │  0.2466  │   0   │   0   │ 0.2466 │ 0.2466 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-rnastralign │ [0.8368] │  0.8368   │  0.8368  │   0   │   0   │ 0.8368 │ 0.8368 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-Archive2    │ [0.0113] │  0.0113   │  0.0113  │   0   │   0   │ 0.0113 │ 0.0113 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-rnastralign │ [0.2406] │  0.2406   │  0.2406  │   0   │   0   │ 0.2406 │ 0.2406 │
╘═══════════════════╧═════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------- https://github.com/yangheng95/metric_visualizer -------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 18:44:46] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:44:46] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:44:46] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:44:46] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843d62160>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1843d620d0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:44:46] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'RnaTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: multimolecule/rnabert
Model Type: rnabert
Model Architecture: ['RnaBertForPreTraining']
Model Parameters: 0.48084 M
Model Config: RnaBertConfig {
  "_name_or_path": "multimolecule/rnabert",
  "architectures": [
    "RnaBertForPreTraining"
  ],
  "attention_dropout": 0.0,
  "bos_token_id": 1,
  "eos_token_id": 2,
  "head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 120,
    "layer_norm_eps": 1e-12,
    "num_labels": 2,
    "output_name": null,
    "problem_type": null,
    "transform": null,
    "transform_act": "gelu"
  },
  "hidden_act": "gelu",
  "hidden_dropout": 0.0,
  "hidden_size": 120,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 40,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "lm_head": {
    "act": null,
    "bias": true,
    "dropout": 0.0,
    "hidden_size": 120,
    "layer_norm_eps": 1e-12,
    "output_name": null,
    "transform": "nonlinear",
    "transform_act": "gelu"
  },
  "mask_token_id": 4,
  "max_position_embeddings": 440,
  "model_type": "rnabert",
  "null_token_id": 5,
  "num_attention_heads": 12,
  "num_hidden_layers": 6,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "ss_vocab_size": 8,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "unk_token_id": 3,
  "use_cache": true,
  "vocab_size": 26
}


[2024-08-03 18:44:46] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
[2024-08-03 18:44:46] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 18:44:46] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 18:44:46] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████| 11304/11304 [00:04<00:00, 2782.36it/s]
[2024-08-03 18:44:52] (0.0.8alpha) {'avg': 133.32130219391365, 'max': 440, 'min': 13}
[2024-08-03 18:44:52] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
[2024-08-03 18:44:52] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 18:44:52] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 18:44:52] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 3028.99it/s]
[2024-08-03 18:44:53] (0.0.8alpha) {'avg': 131.51273885350318, 'max': 440, 'min': 19}
[2024-08-03 18:44:53] (0.0.8alpha) Detected max_length=440 in the dataset, using it as the max_length.
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 140.59it/s]
[2024-08-03 18:44:55] (0.0.8alpha) {'f1_score': 0.4434162132217492, 'matthews_corrcoef': 0.09158151005676468}
Epoch 1/10 Loss: 0.9734: 100%|██████████████| 2826/2826 [02:39<00:00, 17.74it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 136.25it/s]
[2024-08-03 18:47:37] (0.0.8alpha) {'f1_score': 0.41438030253434643, 'matthews_corrcoef': 0.07161978546046698}
Epoch 2/10 Loss: 0.9539: 100%|██████████████| 2826/2826 [02:40<00:00, 17.64it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 136.49it/s]
[2024-08-03 18:50:20] (0.0.8alpha) {'f1_score': 0.38942021989945924, 'matthews_corrcoef': 0.06797040185316015}
Epoch 3/10 Loss: 0.9457: 100%|██████████████| 2826/2826 [02:39<00:00, 17.68it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 136.28it/s]
[2024-08-03 18:53:02] (0.0.8alpha) {'f1_score': 0.4795896281819811, 'matthews_corrcoef': 0.08672428976637146}
Epoch 4/10 Loss: 0.9408: 100%|██████████████| 2826/2826 [02:40<00:00, 17.56it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 136.47it/s]
[2024-08-03 18:55:45] (0.0.8alpha) {'f1_score': 0.4788273033090236, 'matthews_corrcoef': 0.08384478132195566}
Epoch 5/10 Loss: 0.9372: 100%|██████████████| 2826/2826 [02:41<00:00, 17.52it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 136.12it/s]
[2024-08-03 18:58:29] (0.0.8alpha) {'f1_score': 0.43338203632215805, 'matthews_corrcoef': 0.07721758623867671}
Epoch 6/10 Loss: 0.9339: 100%|██████████████| 2826/2826 [02:40<00:00, 17.57it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 136.11it/s]
[2024-08-03 19:01:12] (0.0.8alpha) {'f1_score': 0.43240021620343816, 'matthews_corrcoef': 0.07614541104862894}
Early stopping at epoch 6.
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 140.18it/s]
[2024-08-03 19:01:14] (0.0.8alpha) {'f1_score': 0.4795896281819811, 'matthews_corrcoef': 0.08672428976637146}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 19:01:14] (0.0.8alpha) {'valid': [{'f1_score': 0.4434162132217492, 'matthews_corrcoef': 0.09158151005676468}, {'f1_score': 0.41438030253434643, 'matthews_corrcoef': 0.07161978546046698}], 'best_valid': {'f1_score': 0.4795896281819811, 'matthews_corrcoef': 0.08672428976637146}, 'test': [{'f1_score': 0.4795896281819811, 'matthews_corrcoef': 0.08672428976637146}]}

--------------------------------------------------------------------- Raw Metric Records ---------------------------------------------------------------------
╒═══════════════════╤═════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                               │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-Archive2    │ [0.2466] │  0.2466   │  0.2466  │   0   │   0   │ 0.2466 │ 0.2466 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-rnastralign │ [0.8368] │  0.8368   │  0.8368  │   0   │   0   │ 0.8368 │ 0.8368 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-bpRNA       │ [0.4796] │  0.4796   │  0.4796  │   0   │   0   │ 0.4796 │ 0.4796 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-Archive2    │ [0.0113] │  0.0113   │  0.0113  │   0   │   0   │ 0.0113 │ 0.0113 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-rnastralign │ [0.2406] │  0.2406   │  0.2406  │   0   │   0   │ 0.2406 │ 0.2406 │
├───────────────────┼─────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-RnaBertModel-RNA-SSP-bpRNA       │ [0.0867] │  0.0867   │  0.0867  │   0   │   0   │ 0.0867 │ 0.0867 │
╘═══════════════════╧═════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------- https://github.com/yangheng95/metric_visualizer -------------------------------------------------------

[2024-08-03 19:01:14] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 19:01:14] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 19:01:14] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: genomic_foundation_models/OmniGenomeV3-186M
Tokenizer: None
Device: cuda:1
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-genomic_foundation_models-OmniGenomeV3-186M.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 19:01:14] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 19:01:14] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 19:01:14] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 19:01:14] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f186e757160>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f19106ce8b0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/OmniGenomeV3-186M/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
Some weights of OmniGenomeModel were not initialized from the model checkpoint at genomic_foundation_models/OmniGenomeV3-186M and are newly initialized: ['OmniGenome.pooler.dense.bias', 'OmniGenome.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of OmniGenomeModel were not initialized from the model checkpoint at genomic_foundation_models/OmniGenomeV3-186M and are newly initialized because the shapes did not match:
- OmniGenome.embeddings.position_embeddings.weight: found shape torch.Size([1026, 720]) in the checkpoint and torch.Size([2048, 720]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 19:01:16] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/OmniGenomeV3-186M
Model Type: mprna
Model Architecture: ['OmniGenomeForMaskedLM']
Model Parameters: 186.622641 M
Model Config: OmniGenomeConfig {
  "OmniGenomefold_config": null,
  "_name_or_path": "genomic_foundation_models/OmniGenomeV3-186M",
  "architectures": [
    "OmniGenomeForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "anonymous8/OmniGenome-186M--configuration_omnigenome.OmniGenomeConfig",
    "AutoModel": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeModel",
    "AutoModelForMaskedLM": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForMaskedLM",
    "AutoModelForSeq2SeqLM": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForSeq2SeqLM",
    "AutoModelForSequenceClassification": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForSequenceClassification",
    "AutoModelForTokenClassification": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForTokenClassification"
  },
  "classifier_dropout": null,
  "emb_layer_norm_before": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0,
  "hidden_size": 720,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2560,
  "is_folding_model": false,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-05,
  "mask_token_id": 23,
  "max_position_embeddings": 2048,
  "model_type": "mprna",
  "num_attention_heads": 30,
  "num_generation": 50,
  "num_hidden_layers": 32,
  "num_population": 100,
  "pad_token_id": 1,
  "position_embedding_type": "rotary",
  "token_dropout": true,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "use_cache": true,
  "vocab_list": null,
  "vocab_size": 24
}


[2024-08-03 19:01:16] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:01:16] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 19:01:16] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 19:01:16] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 2333.91it/s]
[2024-08-03 19:01:17] (0.0.8alpha) {'avg': 131.14599483204134, 'max': 501, 'min': 59}
[2024-08-03 19:01:17] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:01:17] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 19:01:17] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 19:01:17] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 2246.70it/s]
[2024-08-03 19:01:17] (0.0.8alpha) {'avg': 136.0326086956522, 'max': 349, 'min': 56}
[2024-08-03 19:01:17] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 28.75it/s]
[2024-08-03 19:01:18] (0.0.8alpha) {'f1_score': 0.24708135066517609, 'matthews_corrcoef': -0.08043506423702917}
Epoch 1/10 Loss: 0.6985: 100%|████████████████| 194/194 [00:27<00:00,  6.95it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.62it/s]
[2024-08-03 19:01:48] (0.0.8alpha) {'f1_score': 0.8674721432973292, 'matthews_corrcoef': 0.3701228025125154}
Epoch 2/10 Loss: 0.6248: 100%|████████████████| 194/194 [00:27<00:00,  6.95it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.57it/s]
[2024-08-03 19:02:19] (0.0.8alpha) {'f1_score': 0.8840444881129251, 'matthews_corrcoef': 0.3772413520502427}
Epoch 3/10 Loss: 0.6109: 100%|████████████████| 194/194 [00:27<00:00,  6.93it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.52it/s]
[2024-08-03 19:02:49] (0.0.8alpha) {'f1_score': 0.8822242776401504, 'matthews_corrcoef': 0.3770402512472836}
Epoch 4/10 Loss: 0.6046: 100%|████████████████| 194/194 [00:28<00:00,  6.93it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.79it/s]
[2024-08-03 19:03:18] (0.0.8alpha) {'f1_score': 0.8875269814993113, 'matthews_corrcoef': 0.3942314236646072}
Epoch 5/10 Loss: 0.6001: 100%|████████████████| 194/194 [00:28<00:00,  6.87it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.55it/s]
[2024-08-03 19:03:48] (0.0.8alpha) {'f1_score': 0.8918953726895466, 'matthews_corrcoef': 0.39222174551720784}
Epoch 6/10 Loss: 0.5958: 100%|████████████████| 194/194 [00:27<00:00,  6.93it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.51it/s]
[2024-08-03 19:04:19] (0.0.8alpha) {'f1_score': 0.893238376729714, 'matthews_corrcoef': 0.39206331599133337}
Epoch 7/10 Loss: 0.5929: 100%|████████████████| 194/194 [00:27<00:00,  6.93it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.51it/s]
[2024-08-03 19:04:49] (0.0.8alpha) {'f1_score': 0.8906599462753277, 'matthews_corrcoef': 0.4044600939096552}
Epoch 8/10 Loss: 0.5896: 100%|████████████████| 194/194 [00:28<00:00,  6.91it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.37it/s]
[2024-08-03 19:05:18] (0.0.8alpha) {'f1_score': 0.8959766552436843, 'matthews_corrcoef': 0.3969788018097115}
Epoch 9/10 Loss: 0.5897: 100%|████████████████| 194/194 [00:27<00:00,  6.95it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.43it/s]
[2024-08-03 19:05:48] (0.0.8alpha) {'f1_score': 0.8996198936913901, 'matthews_corrcoef': 0.39116346829286636}
Epoch 10/10 Loss: 0.5873: 100%|███████████████| 194/194 [00:27<00:00,  6.95it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.43it/s]
[2024-08-03 19:06:19] (0.0.8alpha) {'f1_score': 0.9031596325220163, 'matthews_corrcoef': 0.40166996071283934}
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 29.95it/s]
[2024-08-03 19:06:22] (0.0.8alpha) {'f1_score': 0.9031596325220163, 'matthews_corrcoef': 0.40166996071283934}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 19:06:22] (0.0.8alpha) {'valid': [{'f1_score': 0.24708135066517609, 'matthews_corrcoef': -0.08043506423702917}, {'f1_score': 0.8674721432973292, 'matthews_corrcoef': 0.3701228025125154}], 'best_valid': {'f1_score': 0.9031596325220163, 'matthews_corrcoef': 0.40166996071283934}, 'test': [{'f1_score': 0.9031596325220163, 'matthews_corrcoef': 0.40166996071283934}]}

----------------------------------------------------------------------------------- Raw Metric Records -----------------------------------------------------------------------------------
╒═══════════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                           │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-Archive2 │ [0.9032] │  0.9032   │  0.9032  │   0   │   0   │ 0.9032 │ 0.9032 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-Archive2 │ [0.4017] │  0.4017   │  0.4017  │   0   │   0   │ 0.4017 │ 0.4017 │
╘═══════════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
--------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ---------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 19:06:22] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 19:06:22] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 19:06:22] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 19:06:22] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1842ed81f0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f1842ed8940>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/OmniGenomeV3-186M/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
Some weights of OmniGenomeModel were not initialized from the model checkpoint at genomic_foundation_models/OmniGenomeV3-186M and are newly initialized: ['OmniGenome.pooler.dense.bias', 'OmniGenome.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of OmniGenomeModel were not initialized from the model checkpoint at genomic_foundation_models/OmniGenomeV3-186M and are newly initialized because the shapes did not match:
- OmniGenome.embeddings.position_embeddings.weight: found shape torch.Size([1026, 720]) in the checkpoint and torch.Size([2048, 720]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 19:06:27] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/OmniGenomeV3-186M
Model Type: mprna
Model Architecture: ['OmniGenomeForMaskedLM']
Model Parameters: 186.622641 M
Model Config: OmniGenomeConfig {
  "OmniGenomefold_config": null,
  "_name_or_path": "genomic_foundation_models/OmniGenomeV3-186M",
  "architectures": [
    "OmniGenomeForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "anonymous8/OmniGenome-186M--configuration_omnigenome.OmniGenomeConfig",
    "AutoModel": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeModel",
    "AutoModelForMaskedLM": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForMaskedLM",
    "AutoModelForSeq2SeqLM": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForSeq2SeqLM",
    "AutoModelForSequenceClassification": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForSequenceClassification",
    "AutoModelForTokenClassification": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForTokenClassification"
  },
  "classifier_dropout": null,
  "emb_layer_norm_before": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0,
  "hidden_size": 720,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2560,
  "is_folding_model": false,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-05,
  "mask_token_id": 23,
  "max_position_embeddings": 2048,
  "model_type": "mprna",
  "num_attention_heads": 30,
  "num_generation": 50,
  "num_hidden_layers": 32,
  "num_population": 100,
  "pad_token_id": 1,
  "position_embedding_type": "rotary",
  "token_dropout": true,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "use_cache": true,
  "vocab_list": null,
  "vocab_size": 24
}


[2024-08-03 19:06:27] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:06:27] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 19:06:27] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 19:06:27] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:01<00:00, 2903.91it/s]
[2024-08-03 19:06:29] (0.0.8alpha) {'avg': 102.8957415565345, 'max': 501, 'min': 55}
[2024-08-03 19:06:29] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:06:29] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 19:06:29] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 19:06:29] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 2990.91it/s]
[2024-08-03 19:06:29] (0.0.8alpha) {'avg': 103.2012987012987, 'max': 488, 'min': 72}
[2024-08-03 19:06:29] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.34it/s]
[2024-08-03 19:06:34] (0.0.8alpha) {'f1_score': 0.23955673916582995, 'matthews_corrcoef': -0.059087867038305965}
Epoch 1/10 Loss: 0.5930: 100%|██████████████| 1022/1022 [02:28<00:00,  6.86it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.23it/s]
[2024-08-03 19:09:09] (0.0.8alpha) {'f1_score': 0.9710906993980634, 'matthews_corrcoef': 0.4010824370441786}
Epoch 2/10 Loss: 0.5734: 100%|██████████████| 1022/1022 [02:29<00:00,  6.85it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.33it/s]
[2024-08-03 19:11:45] (0.0.8alpha) {'f1_score': 0.9739524424074147, 'matthews_corrcoef': 0.34714072341792335}
Epoch 3/10 Loss: 0.5699: 100%|██████████████| 1022/1022 [02:29<00:00,  6.84it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.33it/s]
[2024-08-03 19:14:21] (0.0.8alpha) {'f1_score': 0.9743957295501303, 'matthews_corrcoef': 0.36926968265824583}
Epoch 4/10 Loss: 0.5677: 100%|██████████████| 1022/1022 [02:29<00:00,  6.85it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.32it/s]
[2024-08-03 19:16:56] (0.0.8alpha) {'f1_score': 0.9738274302049442, 'matthews_corrcoef': 0.38590700337408573}
Epoch 5/10 Loss: 0.5655: 100%|██████████████| 1022/1022 [02:29<00:00,  6.84it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.29it/s]
[2024-08-03 19:19:31] (0.0.8alpha) {'f1_score': 0.9755442685237612, 'matthews_corrcoef': 0.35517967880321005}
Epoch 6/10 Loss: 0.5646: 100%|██████████████| 1022/1022 [02:29<00:00,  6.83it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.30it/s]
[2024-08-03 19:22:07] (0.0.8alpha) {'f1_score': 0.9755105255356825, 'matthews_corrcoef': 0.37601237555450717}
Epoch 7/10 Loss: 0.5635: 100%|██████████████| 1022/1022 [02:29<00:00,  6.83it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.29it/s]
[2024-08-03 19:24:41] (0.0.8alpha) {'f1_score': 0.9777331943753684, 'matthews_corrcoef': 0.34784707839909007}
Epoch 8/10 Loss: 0.5630: 100%|██████████████| 1022/1022 [02:29<00:00,  6.84it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.30it/s]
[2024-08-03 19:27:17] (0.0.8alpha) {'f1_score': 0.9764378633235973, 'matthews_corrcoef': 0.36347489248222714}
Epoch 9/10 Loss: 0.5625: 100%|██████████████| 1022/1022 [02:29<00:00,  6.85it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.29it/s]
[2024-08-03 19:29:51] (0.0.8alpha) {'f1_score': 0.9763739046983195, 'matthews_corrcoef': 0.3549155767322146}
Epoch 10/10 Loss: 0.5613: 100%|█████████████| 1022/1022 [02:29<00:00,  6.86it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.29it/s]
[2024-08-03 19:32:25] (0.0.8alpha) {'f1_score': 0.978215976086393, 'matthews_corrcoef': 0.33486549834920637}
Testing: 100%|████████████████████████████████| 116/116 [00:04<00:00, 24.37it/s]
[2024-08-03 19:32:32] (0.0.8alpha) {'f1_score': 0.978215976086393, 'matthews_corrcoef': 0.33486549834920637}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 19:32:32] (0.0.8alpha) {'valid': [{'f1_score': 0.23955673916582995, 'matthews_corrcoef': -0.059087867038305965}, {'f1_score': 0.9710906993980634, 'matthews_corrcoef': 0.4010824370441786}], 'best_valid': {'f1_score': 0.978215976086393, 'matthews_corrcoef': 0.33486549834920637}, 'test': [{'f1_score': 0.978215976086393, 'matthews_corrcoef': 0.33486549834920637}]}

------------------------------------------------------------------------------------- Raw Metric Records -------------------------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                              │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-Archive2    │ [0.9032] │  0.9032   │  0.9032  │   0   │   0   │ 0.9032 │ 0.9032 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-rnastralign │ [0.9782] │  0.9782   │  0.9782  │   0   │   0   │ 0.9782 │ 0.9782 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-Archive2    │ [0.4017] │  0.4017   │  0.4017  │   0   │   0   │ 0.4017 │ 0.4017 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-rnastralign │ [0.3349] │  0.3349   │  0.3349  │   0   │   0   │ 0.3349 │ 0.3349 │
╘═══════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 19:32:32] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 19:32:32] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 19:32:32] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 19:32:32] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f17c6894f70>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f17c66d8af0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/OmniGenomeV3-186M/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
Some weights of OmniGenomeModel were not initialized from the model checkpoint at genomic_foundation_models/OmniGenomeV3-186M and are newly initialized: ['OmniGenome.pooler.dense.bias', 'OmniGenome.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of OmniGenomeModel were not initialized from the model checkpoint at genomic_foundation_models/OmniGenomeV3-186M and are newly initialized because the shapes did not match:
- OmniGenome.embeddings.position_embeddings.weight: found shape torch.Size([1026, 720]) in the checkpoint and torch.Size([2048, 720]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 19:32:37] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/OmniGenomeV3-186M
Model Type: mprna
Model Architecture: ['OmniGenomeForMaskedLM']
Model Parameters: 186.622641 M
Model Config: OmniGenomeConfig {
  "OmniGenomefold_config": null,
  "_name_or_path": "genomic_foundation_models/OmniGenomeV3-186M",
  "architectures": [
    "OmniGenomeForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "anonymous8/OmniGenome-186M--configuration_omnigenome.OmniGenomeConfig",
    "AutoModel": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeModel",
    "AutoModelForMaskedLM": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForMaskedLM",
    "AutoModelForSeq2SeqLM": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForSeq2SeqLM",
    "AutoModelForSequenceClassification": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForSequenceClassification",
    "AutoModelForTokenClassification": "anonymous8/OmniGenome-186M--modeling_omnigenome.OmniGenomeForTokenClassification"
  },
  "classifier_dropout": null,
  "emb_layer_norm_before": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0,
  "hidden_size": 720,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2560,
  "is_folding_model": false,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-05,
  "mask_token_id": 23,
  "max_position_embeddings": 2048,
  "model_type": "mprna",
  "num_attention_heads": 30,
  "num_generation": 50,
  "num_hidden_layers": 32,
  "num_population": 100,
  "pad_token_id": 1,
  "position_embedding_type": "rotary",
  "token_dropout": true,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "use_cache": true,
  "vocab_list": null,
  "vocab_size": 24
}


[2024-08-03 19:32:37] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:32:37] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 19:32:37] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 19:32:37] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████| 11304/11304 [00:05<00:00, 2214.18it/s]
[2024-08-03 19:32:45] (0.0.8alpha) {'avg': 134.3696921443737, 'max': 512, 'min': 12}
[2024-08-03 19:32:45] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:32:45] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 19:32:45] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 19:32:45] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 2396.36it/s]
[2024-08-03 19:32:45] (0.0.8alpha) {'avg': 132.04777070063693, 'max': 512, 'min': 19}
[2024-08-03 19:32:45] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.50it/s]
[2024-08-03 19:33:00] (0.0.8alpha) {'f1_score': 0.22937795514737844, 'matthews_corrcoef': -0.07688943582965854}
Epoch 1/10 Loss: 0.7728: 100%|██████████████| 2826/2826 [06:58<00:00,  6.75it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.45it/s]
[2024-08-03 19:40:14] (0.0.8alpha) {'f1_score': 0.7707376294655357, 'matthews_corrcoef': 0.23167678251672655}
Epoch 2/10 Loss: 0.7205: 100%|██████████████| 2826/2826 [06:59<00:00,  6.73it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.45it/s]
[2024-08-03 19:47:30] (0.0.8alpha) {'f1_score': 0.7901397428286736, 'matthews_corrcoef': 0.2516385217917132}
Epoch 3/10 Loss: 0.6915: 100%|██████████████| 2826/2826 [06:59<00:00,  6.73it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.44it/s]
[2024-08-03 19:54:46] (0.0.8alpha) {'f1_score': 0.8071013679548518, 'matthews_corrcoef': 0.24389385952460424}
Epoch 4/10 Loss: 0.6714: 100%|██████████████| 2826/2826 [07:01<00:00,  6.71it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.43it/s]
[2024-08-03 20:02:03] (0.0.8alpha) {'f1_score': 0.8142938602047151, 'matthews_corrcoef': 0.2537111497466495}
Epoch 5/10 Loss: 0.6565: 100%|██████████████| 2826/2826 [07:02<00:00,  6.69it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:14<00:00, 22.43it/s]
[2024-08-03 20:09:21] (0.0.8alpha) {'f1_score': 0.8202817096695044, 'matthews_corrcoef': 0.26304293846042937}
Epoch 6/10 Loss: 0.6448: 100%|██████████████| 2826/2826 [07:01<00:00,  6.70it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:14<00:00, 22.42it/s]
[2024-08-03 20:16:39] (0.0.8alpha) {'f1_score': 0.8241216835908002, 'matthews_corrcoef': 0.26076094974149067}
Epoch 7/10 Loss: 0.6361: 100%|██████████████| 2826/2826 [06:55<00:00,  6.80it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.61it/s]
[2024-08-03 20:23:51] (0.0.8alpha) {'f1_score': 0.8283325696361391, 'matthews_corrcoef': 0.264155526524681}
Epoch 8/10 Loss: 0.6292: 100%|██████████████| 2826/2826 [06:52<00:00,  6.85it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.60it/s]
[2024-08-03 20:30:59] (0.0.8alpha) {'f1_score': 0.8280627697745006, 'matthews_corrcoef': 0.26092729945383014}
Epoch 9/10 Loss: 0.6236: 100%|██████████████| 2826/2826 [06:52<00:00,  6.85it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.59it/s]
[2024-08-03 20:38:06] (0.0.8alpha) {'f1_score': 0.8308348850830868, 'matthews_corrcoef': 0.25722756858074686}
Epoch 10/10 Loss: 0.6182: 100%|█████████████| 2826/2826 [06:52<00:00,  6.85it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.61it/s]
[2024-08-03 20:45:14] (0.0.8alpha) {'f1_score': 0.8308605316526174, 'matthews_corrcoef': 0.27699146081873893}
Testing: 100%|████████████████████████████████| 314/314 [00:13<00:00, 22.71it/s]
[2024-08-03 20:45:31] (0.0.8alpha) {'f1_score': 0.8308605316526174, 'matthews_corrcoef': 0.27699146081873893}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 20:45:31] (0.0.8alpha) {'valid': [{'f1_score': 0.22937795514737844, 'matthews_corrcoef': -0.07688943582965854}, {'f1_score': 0.7707376294655357, 'matthews_corrcoef': 0.23167678251672655}], 'best_valid': {'f1_score': 0.8308605316526174, 'matthews_corrcoef': 0.27699146081873893}, 'test': [{'f1_score': 0.8308605316526174, 'matthews_corrcoef': 0.27699146081873893}]}

------------------------------------------------------------------------------------- Raw Metric Records -------------------------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                              │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-Archive2    │ [0.9032] │  0.9032   │  0.9032  │   0   │   0   │ 0.9032 │ 0.9032 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-rnastralign │ [0.9782] │  0.9782   │  0.9782  │   0   │   0   │ 0.9782 │ 0.9782 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-bpRNA       │ [0.8309] │  0.8309   │  0.8309  │   0   │   0   │ 0.8309 │ 0.8309 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-Archive2    │ [0.4017] │  0.4017   │  0.4017  │   0   │   0   │ 0.4017 │ 0.4017 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-rnastralign │ [0.3349] │  0.3349   │  0.3349  │   0   │   0   │ 0.3349 │ 0.3349 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/OmniGenomeV3-186M-RNA-SSP-bpRNA       │ [0.277]  │   0.277   │  0.277   │   0   │   0   │ 0.277  │ 0.277  │
╘═══════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------------------------

/home/yangheng/miniconda3/lib/python3.9/tempfile.py:821: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/home/yangheng/omnigenome/examples/benchmark/tmpu1gkhot1'>
  _warnings.warn(warn_message, ResourceWarning)

Process finished with exit code 0

/home/yangheng/miniconda3/bin/python /home/yangheng/omnigenome/examples/benchmark/batch_rgb_benchmark.py
Version 0.9.12 of metric_visualizer is outdated. Version 0.9.13 was released Wednesday May 01, 2024.
2024-08-03 17:01:12.710295: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-08-03 17:01:12.710329: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-08-03 17:01:12.711442: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-08-03 17:01:12.718141: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-08-03 17:01:13.629442: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
[2024-08-03 17:01:15] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 17:01:15] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 17:01:15] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: genomic_foundation_models/SpliceBERT-510nt
Tokenizer: None
Device: cuda:0
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-genomic_foundation_models-SpliceBERT-510nt.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 17:01:15] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:01:15] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:01:15] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:01:15] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e73f39d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e73f3280>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/miniconda3/lib/python3.9/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Some weights of BertModel were not initialized from the model checkpoint at genomic_foundation_models/SpliceBERT-510nt and are newly initialized: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:01:15] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/SpliceBERT-510nt
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 19.446272 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/SpliceBERT-510nt",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 16,
  "num_hidden_layers": 6,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 10
}


[2024-08-03 17:01:15] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:01:15] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 17:01:15] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 17:01:15] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  0%|                                                   | 0/774 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 4784.67it/s]
[2024-08-03 17:01:15] (0.0.8alpha) {'avg': 131.14599483204134, 'max': 501, 'min': 59}
[2024-08-03 17:01:15] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:01:15] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 17:01:15] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 17:01:15] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 4598.25it/s]
[2024-08-03 17:01:15] (0.0.8alpha) {'avg': 136.0326086956522, 'max': 349, 'min': 56}
[2024-08-03 17:01:15] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 28.01it/s]
[2024-08-03 17:01:16] (0.0.8alpha) {'f1_score': 0.25832638019579585, 'matthews_corrcoef': 0.009228072148777765}
Epoch 1/10 Loss: 0.9886: 100%|████████████████| 194/194 [00:08<00:00, 23.67it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 90.67it/s]
[2024-08-03 17:01:25] (0.0.8alpha) {'f1_score': 0.667899588296323, 'matthews_corrcoef': 0.19716120783626603}
Epoch 2/10 Loss: 0.8109: 100%|████████████████| 194/194 [00:08<00:00, 23.71it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 89.33it/s]
[2024-08-03 17:01:34] (0.0.8alpha) {'f1_score': 0.7194248584654894, 'matthews_corrcoef': 0.229483806739546}
Epoch 3/10 Loss: 0.7574: 100%|████████████████| 194/194 [00:08<00:00, 23.72it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 89.76it/s]
[2024-08-03 17:01:42] (0.0.8alpha) {'f1_score': 0.7384707636674769, 'matthews_corrcoef': 0.2417417024453872}
Epoch 4/10 Loss: 0.7340: 100%|████████████████| 194/194 [00:08<00:00, 23.60it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 91.95it/s]
[2024-08-03 17:01:51] (0.0.8alpha) {'f1_score': 0.7583129992339281, 'matthews_corrcoef': 0.25496054285339215}
Epoch 5/10 Loss: 0.7162: 100%|████████████████| 194/194 [00:06<00:00, 27.87it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 93.05it/s]
[2024-08-03 17:01:59] (0.0.8alpha) {'f1_score': 0.7680337524043837, 'matthews_corrcoef': 0.2608790986167255}
Epoch 6/10 Loss: 0.7066: 100%|████████████████| 194/194 [00:04<00:00, 41.75it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 92.89it/s]
[2024-08-03 17:02:04] (0.0.8alpha) {'f1_score': 0.7651482279324547, 'matthews_corrcoef': 0.2599117464417442}
Epoch 7/10 Loss: 0.6978: 100%|████████████████| 194/194 [00:04<00:00, 42.23it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 92.33it/s]
[2024-08-03 17:02:09] (0.0.8alpha) {'f1_score': 0.7803083973286311, 'matthews_corrcoef': 0.2681183526047812}
Epoch 8/10 Loss: 0.6865: 100%|████████████████| 194/194 [00:04<00:00, 42.19it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 96.01it/s]
[2024-08-03 17:02:14] (0.0.8alpha) {'f1_score': 0.7897478612694918, 'matthews_corrcoef': 0.27373955447387643}
Epoch 9/10 Loss: 0.6830: 100%|████████████████| 194/194 [00:04<00:00, 41.97it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 93.11it/s]
[2024-08-03 17:02:19] (0.0.8alpha) {'f1_score': 0.7954959100718176, 'matthews_corrcoef': 0.27817763438076115}
Epoch 10/10 Loss: 0.6763: 100%|███████████████| 194/194 [00:04<00:00, 42.13it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 95.92it/s]
[2024-08-03 17:02:24] (0.0.8alpha) {'f1_score': 0.7988869771370024, 'matthews_corrcoef': 0.27994279858357035}
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 92.10it/s]
[2024-08-03 17:02:25] (0.0.8alpha) {'f1_score': 0.7988869771370024, 'matthews_corrcoef': 0.27994279858357035}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:02:25] (0.0.8alpha) {'valid': [{'f1_score': 0.25832638019579585, 'matthews_corrcoef': 0.009228072148777765}, {'f1_score': 0.667899588296323, 'matthews_corrcoef': 0.19716120783626603}], 'best_valid': {'f1_score': 0.7988869771370024, 'matthews_corrcoef': 0.27994279858357035}, 'test': [{'f1_score': 0.7988869771370024, 'matthews_corrcoef': 0.27994279858357035}]}

----------------------------------------------------------------------------------- Raw Metric Records -----------------------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                          │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-Archive2 │ [0.7989] │  0.7989   │  0.7989  │   0   │   0   │ 0.7989 │ 0.7989 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-Archive2 │ [0.2799] │  0.2799   │  0.2799  │   0   │   0   │ 0.2799 │ 0.2799 │
╘═══════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
-------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer --------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 17:02:25] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:02:25] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:02:25] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:02:25] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85621479d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f8562147ca0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
Some weights of BertModel were not initialized from the model checkpoint at genomic_foundation_models/SpliceBERT-510nt and are newly initialized: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:02:25] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/SpliceBERT-510nt
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 19.446272 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/SpliceBERT-510nt",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 16,
  "num_hidden_layers": 6,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 10
}


[2024-08-03 17:02:25] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:02:25] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 17:02:25] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 17:02:25] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  0%|                                                  | 0/4086 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
100%|█████████████████████████████████████| 4086/4086 [00:00<00:00, 5693.17it/s]
[2024-08-03 17:02:26] (0.0.8alpha) {'avg': 102.8957415565345, 'max': 501, 'min': 55}
[2024-08-03 17:02:26] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:02:26] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 17:02:26] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 17:02:26] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 6101.94it/s]
[2024-08-03 17:02:27] (0.0.8alpha) {'avg': 103.2012987012987, 'max': 488, 'min': 72}
[2024-08-03 17:02:27] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 92.81it/s]
[2024-08-03 17:02:28] (0.0.8alpha) {'f1_score': 0.24749969426345542, 'matthews_corrcoef': 0.015377169067193466}
Epoch 1/10 Loss: 0.7007: 100%|██████████████| 1022/1022 [00:28<00:00, 35.49it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 125.12it/s]
[2024-08-03 17:02:58] (0.0.8alpha) {'f1_score': 0.9134904900405535, 'matthews_corrcoef': 0.24675121738995914}
Epoch 2/10 Loss: 0.6236: 100%|██████████████| 1022/1022 [00:29<00:00, 35.04it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 126.16it/s]
[2024-08-03 17:03:28] (0.0.8alpha) {'f1_score': 0.9163672447539244, 'matthews_corrcoef': 0.24706576919402115}
Epoch 3/10 Loss: 0.6156: 100%|██████████████| 1022/1022 [00:29<00:00, 34.49it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 125.41it/s]
[2024-08-03 17:03:59] (0.0.8alpha) {'f1_score': 0.9235155990755192, 'matthews_corrcoef': 0.2501682654842146}
Epoch 4/10 Loss: 0.6102: 100%|██████████████| 1022/1022 [00:42<00:00, 23.88it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 125.27it/s]
[2024-08-03 17:04:43] (0.0.8alpha) {'f1_score': 0.9250447030095525, 'matthews_corrcoef': 0.2509550677037866}
Epoch 5/10 Loss: 0.6053: 100%|██████████████| 1022/1022 [00:31<00:00, 32.89it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 119.45it/s]
[2024-08-03 17:05:16] (0.0.8alpha) {'f1_score': 0.9284931983558989, 'matthews_corrcoef': 0.25228889138647087}
Epoch 6/10 Loss: 0.6026: 100%|██████████████| 1022/1022 [00:30<00:00, 33.27it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 123.02it/s]
[2024-08-03 17:05:48] (0.0.8alpha) {'f1_score': 0.931557465035279, 'matthews_corrcoef': 0.2542363804723521}
Epoch 7/10 Loss: 0.5992: 100%|██████████████| 1022/1022 [00:42<00:00, 23.99it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 124.79it/s]
[2024-08-03 17:06:31] (0.0.8alpha) {'f1_score': 0.9342151839415656, 'matthews_corrcoef': 0.2543721579921586}
Epoch 8/10 Loss: 0.5973: 100%|██████████████| 1022/1022 [00:41<00:00, 24.57it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 116.24it/s]
[2024-08-03 17:07:14] (0.0.8alpha) {'f1_score': 0.93711011495532, 'matthews_corrcoef': 0.25628553448670244}
Epoch 9/10 Loss: 0.5946: 100%|██████████████| 1022/1022 [00:43<00:00, 23.28it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 177.27it/s]
[2024-08-03 17:07:59] (0.0.8alpha) {'f1_score': 0.9375653231415167, 'matthews_corrcoef': 0.2556400015634763}
Epoch 10/10 Loss: 0.5923: 100%|█████████████| 1022/1022 [00:43<00:00, 23.54it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 174.51it/s]
[2024-08-03 17:08:44] (0.0.8alpha) {'f1_score': 0.9381096817291473, 'matthews_corrcoef': 0.2558218791262724}
Testing: 100%|███████████████████████████████| 116/116 [00:00<00:00, 187.41it/s]
[2024-08-03 17:08:45] (0.0.8alpha) {'f1_score': 0.9381096817291473, 'matthews_corrcoef': 0.2558218791262724}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:08:45] (0.0.8alpha) {'valid': [{'f1_score': 0.24749969426345542, 'matthews_corrcoef': 0.015377169067193466}, {'f1_score': 0.9134904900405535, 'matthews_corrcoef': 0.24675121738995914}], 'best_valid': {'f1_score': 0.9381096817291473, 'matthews_corrcoef': 0.2558218791262724}, 'test': [{'f1_score': 0.9381096817291473, 'matthews_corrcoef': 0.2558218791262724}]}

------------------------------------------------------------------------------------ Raw Metric Records ------------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                             │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-Archive2    │ [0.7989] │  0.7989   │  0.7989  │   0   │   0   │ 0.7989 │ 0.7989 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-rnastralign │ [0.9381] │  0.9381   │  0.9381  │   0   │   0   │ 0.9381 │ 0.9381 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-Archive2    │ [0.2799] │  0.2799   │  0.2799  │   0   │   0   │ 0.2799 │ 0.2799 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-rnastralign │ [0.2558] │  0.2558   │  0.2558  │   0   │   0   │ 0.2558 │ 0.2558 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 17:08:45] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:08:45] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:08:45] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:08:45] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85621470d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85621473a0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
Some weights of BertModel were not initialized from the model checkpoint at genomic_foundation_models/SpliceBERT-510nt and are newly initialized: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:08:45] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/SpliceBERT-510nt
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 19.446272 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/SpliceBERT-510nt",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "classifier_dropout": null,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 16,
  "num_hidden_layers": 6,
  "output_hidden_states": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 10
}


[2024-08-03 17:08:45] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:08:45] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 17:08:45] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 17:08:45] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  0%|                                                 | 0/11304 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
  8%|███                                  | 946/11304 [00:00<00:02, 4743.90it/s]genomic_foundation_models/SpliceBERT-510nt/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.21428571428571427% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
genomic_foundation_models/SpliceBERT-510nt/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.10909090909090909% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
 78%|████████████████████████████        | 8823/11304 [00:01<00:00, 5134.94it/s]genomic_foundation_models/SpliceBERT-510nt/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.14285714285714285% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
 87%|███████████████████████████████▎    | 9845/11304 [00:02<00:00, 3315.94it/s]genomic_foundation_models/SpliceBERT-510nt/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.10526315789473684% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
100%|███████████████████████████████████| 11304/11304 [00:02<00:00, 4585.44it/s]
[2024-08-03 17:08:49] (0.0.8alpha) {'avg': 134.37039985845718, 'max': 512, 'min': 13}
[2024-08-03 17:08:49] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:08:49] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 17:08:49] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 17:08:49] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 5302.11it/s]
[2024-08-03 17:08:50] (0.0.8alpha) {'avg': 132.0485668789809, 'max': 512, 'min': 19}
[2024-08-03 17:08:50] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 192.96it/s]
[2024-08-03 17:08:52] (0.0.8alpha) {'f1_score': 0.25556615338747213, 'matthews_corrcoef': 0.02389031573757048}
Epoch 1/10 Loss: 0.9244: 100%|██████████████| 2826/2826 [01:59<00:00, 23.62it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 188.39it/s]
[2024-08-03 17:10:54] (0.0.8alpha) {'f1_score': 0.5855665027653257, 'matthews_corrcoef': 0.10757977850645958}
Epoch 2/10 Loss: 0.8721: 100%|██████████████| 2826/2826 [02:00<00:00, 23.53it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 188.43it/s]
[2024-08-03 17:12:56] (0.0.8alpha) {'f1_score': 0.6160125333073755, 'matthews_corrcoef': 0.1290172244827615}
Epoch 3/10 Loss: 0.8443: 100%|██████████████| 2826/2826 [02:00<00:00, 23.54it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 188.79it/s]
[2024-08-03 17:14:58] (0.0.8alpha) {'f1_score': 0.6495873017714625, 'matthews_corrcoef': 0.13692707357129952}
Epoch 4/10 Loss: 0.8230: 100%|██████████████| 2826/2826 [02:00<00:00, 23.41it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 188.47it/s]
[2024-08-03 17:17:01] (0.0.8alpha) {'f1_score': 0.6661453405452576, 'matthews_corrcoef': 0.1449190251599107}
Epoch 5/10 Loss: 0.8061: 100%|██████████████| 2826/2826 [02:00<00:00, 23.52it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 190.27it/s]
[2024-08-03 17:19:03] (0.0.8alpha) {'f1_score': 0.6793660740014662, 'matthews_corrcoef': 0.15159015020699307}
Epoch 6/10 Loss: 0.7926: 100%|██████████████| 2826/2826 [02:00<00:00, 23.41it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 188.44it/s]
[2024-08-03 17:21:06] (0.0.8alpha) {'f1_score': 0.6851503109027041, 'matthews_corrcoef': 0.15400407468957997}
Epoch 7/10 Loss: 0.7809: 100%|██████████████| 2826/2826 [02:00<00:00, 23.53it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 187.20it/s]
[2024-08-03 17:23:08] (0.0.8alpha) {'f1_score': 0.6970424588855556, 'matthews_corrcoef': 0.16001195664643664}
Epoch 8/10 Loss: 0.7701: 100%|██████████████| 2826/2826 [02:00<00:00, 23.47it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 191.91it/s]
[2024-08-03 17:25:11] (0.0.8alpha) {'f1_score': 0.7037789853407134, 'matthews_corrcoef': 0.16146037645397515}
Epoch 9/10 Loss: 0.7607: 100%|██████████████| 2826/2826 [01:59<00:00, 23.68it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 188.39it/s]
[2024-08-03 17:27:12] (0.0.8alpha) {'f1_score': 0.7111899667515299, 'matthews_corrcoef': 0.1664831506378706}
Epoch 10/10 Loss: 0.7524: 100%|█████████████| 2826/2826 [02:01<00:00, 23.24it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 187.19it/s]
[2024-08-03 17:29:16] (0.0.8alpha) {'f1_score': 0.7159223208338301, 'matthews_corrcoef': 0.1657608859002227}
Testing: 100%|███████████████████████████████| 314/314 [00:01<00:00, 189.51it/s]
[2024-08-03 17:29:18] (0.0.8alpha) {'f1_score': 0.7159223208338301, 'matthews_corrcoef': 0.1657608859002227}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:29:18] (0.0.8alpha) {'valid': [{'f1_score': 0.25556615338747213, 'matthews_corrcoef': 0.02389031573757048}, {'f1_score': 0.5855665027653257, 'matthews_corrcoef': 0.10757977850645958}], 'best_valid': {'f1_score': 0.7159223208338301, 'matthews_corrcoef': 0.1657608859002227}, 'test': [{'f1_score': 0.7159223208338301, 'matthews_corrcoef': 0.1657608859002227}]}

------------------------------------------------------------------------------------ Raw Metric Records ------------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                             │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-Archive2    │ [0.7989] │  0.7989   │  0.7989  │   0   │   0   │ 0.7989 │ 0.7989 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-rnastralign │ [0.9381] │  0.9381   │  0.9381  │   0   │   0   │ 0.9381 │ 0.9381 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-bpRNA       │ [0.7159] │  0.7159   │  0.7159  │   0   │   0   │ 0.7159 │ 0.7159 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-Archive2    │ [0.2799] │  0.2799   │  0.2799  │   0   │   0   │ 0.2799 │ 0.2799 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-rnastralign │ [0.2558] │  0.2558   │  0.2558  │   0   │   0   │ 0.2558 │ 0.2558 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/SpliceBERT-510nt-RNA-SSP-bpRNA       │ [0.1658] │  0.1658   │  0.1658  │   0   │   0   │ 0.1658 │ 0.1658 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------------------------

[2024-08-03 17:29:18] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 17:29:18] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 17:29:18] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: genomic_foundation_models/DNABERT-2-117M
Tokenizer: None
Device: cuda:0
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-genomic_foundation_models-DNABERT-2-117M.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 17:29:18] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:29:18] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:29:18] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:29:18] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85643a9160>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f856439cee0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/DNABERT-2-117M/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
/home/yangheng/.cache/huggingface/modules/transformers_modules/DNABERT-2-117M/bert_layers.py:130: UserWarning: Unable to import Triton; defaulting MosaicBERT attention implementation to pytorch (this will reduce throughput when using this model).
  warnings.warn(
Some weights of BertModel were not initialized from the model checkpoint at genomic_foundation_models/DNABERT-2-117M and are newly initialized: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:29:19] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/DNABERT-2-117M
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 117.068544 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/DNABERT-2-117M",
  "alibi_starting_size": 512,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_bert.BertConfig",
    "AutoModel": "bert_layers.BertModel",
    "AutoModelForMaskedLM": "bert_layers.BertForMaskedLM",
    "AutoModelForSequenceClassification": "bert_layers.BertForSequenceClassification"
  },
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 4096
}


[2024-08-03 17:29:19] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:29:19] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 17:29:19] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 17:29:19] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 4155.73it/s]
[2024-08-03 17:29:19] (0.0.8alpha) {'avg': 69.37855297157623, 'max': 307, 'min': 30}
[2024-08-03 17:29:19] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:29:19] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 17:29:19] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 17:29:19] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 4166.86it/s]
[2024-08-03 17:29:19] (0.0.8alpha) {'avg': 72.21739130434783, 'max': 200, 'min': 34}
[2024-08-03 17:29:19] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing:   0%|                                           | 0/23 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 71.65it/s]
[2024-08-03 17:29:20] (0.0.8alpha) {'f1_score': 0.2889828348463968, 'matthews_corrcoef': 0.08735262414572653}
Epoch 1/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 1/10 Loss: 1.0383: 100%|████████████████| 194/194 [00:12<00:00, 14.97it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 79.27it/s]
[2024-08-03 17:29:34] (0.0.8alpha) {'f1_score': 0.4761759326968551, 'matthews_corrcoef': 0.16814266255888027}
Epoch 2/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 2/10 Loss: 1.0176: 100%|████████████████| 194/194 [00:12<00:00, 15.07it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 79.13it/s]
[2024-08-03 17:29:48] (0.0.8alpha) {'f1_score': 0.5030097945146116, 'matthews_corrcoef': 0.19034923918221092}
Epoch 3/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 3/10 Loss: 1.0083: 100%|████████████████| 194/194 [00:12<00:00, 15.03it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 79.08it/s]
[2024-08-03 17:30:03] (0.0.8alpha) {'f1_score': 0.5215831812189349, 'matthews_corrcoef': 0.21203268010971685}
Epoch 4/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 4/10 Loss: 0.9950: 100%|████████████████| 194/194 [00:12<00:00, 15.04it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 77.88it/s]
[2024-08-03 17:30:17] (0.0.8alpha) {'f1_score': 0.526030753511048, 'matthews_corrcoef': 0.21354031578105356}
Epoch 5/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 5/10 Loss: 0.9892: 100%|████████████████| 194/194 [00:12<00:00, 15.10it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 79.00it/s]
[2024-08-03 17:30:31] (0.0.8alpha) {'f1_score': 0.5424399487650797, 'matthews_corrcoef': 0.21955826390277478}
Epoch 6/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 6/10 Loss: 0.9778: 100%|████████████████| 194/194 [00:12<00:00, 15.02it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 78.16it/s]
[2024-08-03 17:30:45] (0.0.8alpha) {'f1_score': 0.5260182370910594, 'matthews_corrcoef': 0.21327915650147114}
Epoch 7/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 7/10 Loss: 0.9737: 100%|████████████████| 194/194 [00:12<00:00, 15.10it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 78.14it/s]
[2024-08-03 17:30:58] (0.0.8alpha) {'f1_score': 0.5504097644970677, 'matthews_corrcoef': 0.23104745061338702}
Epoch 8/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 8/10 Loss: 0.9608: 100%|████████████████| 194/194 [00:12<00:00, 15.10it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 78.77it/s]
[2024-08-03 17:31:12] (0.0.8alpha) {'f1_score': 0.5404201008271823, 'matthews_corrcoef': 0.22521056417518376}
Epoch 9/10 Loss::   0%|                                 | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 9/10 Loss: 0.9556: 100%|████████████████| 194/194 [00:12<00:00, 15.06it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 78.99it/s]
[2024-08-03 17:31:26] (0.0.8alpha) {'f1_score': 0.557295130203604, 'matthews_corrcoef': 0.23073639223586648}
Epoch 10/10 Loss::   0%|                                | 0/194 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 10/10 Loss: 0.9486: 100%|███████████████| 194/194 [00:12<00:00, 15.08it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 78.86it/s]
[2024-08-03 17:31:40] (0.0.8alpha) {'f1_score': 0.557064972530858, 'matthews_corrcoef': 0.2380601851244592}
Testing:   0%|                                           | 0/23 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 80.86it/s]
[2024-08-03 17:31:40] (0.0.8alpha) {'f1_score': 0.557295130203604, 'matthews_corrcoef': 0.23073639223586648}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:31:40] (0.0.8alpha) {'valid': [{'f1_score': 0.2889828348463968, 'matthews_corrcoef': 0.08735262414572653}, {'f1_score': 0.4761759326968551, 'matthews_corrcoef': 0.16814266255888027}], 'best_valid': {'f1_score': 0.557295130203604, 'matthews_corrcoef': 0.23073639223586648}, 'test': [{'f1_score': 0.557295130203604, 'matthews_corrcoef': 0.23073639223586648}]}

---------------------------------------------------------------------------------- Raw Metric Records ----------------------------------------------------------------------------------
╒═══════════════════╤══════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                        │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪══════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-Archive2 │ [0.5573] │  0.5573   │  0.5573  │   0   │   0   │ 0.5573 │ 0.5573 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-Archive2 │ [0.2307] │  0.2307   │  0.2307  │   0   │   0   │ 0.2307 │ 0.2307 │
╘═══════════════════╧══════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer -------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 17:31:40] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:31:40] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:31:40] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:31:40] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e2cdae50>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e2cdaee0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/DNABERT-2-117M/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
/home/yangheng/.cache/huggingface/modules/transformers_modules/DNABERT-2-117M/bert_layers.py:130: UserWarning: Unable to import Triton; defaulting MosaicBERT attention implementation to pytorch (this will reduce throughput when using this model).
  warnings.warn(
Some weights of BertModel were not initialized from the model checkpoint at genomic_foundation_models/DNABERT-2-117M and are newly initialized: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:31:41] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/DNABERT-2-117M
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 117.068544 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/DNABERT-2-117M",
  "alibi_starting_size": 512,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_bert.BertConfig",
    "AutoModel": "bert_layers.BertModel",
    "AutoModelForMaskedLM": "bert_layers.BertForMaskedLM",
    "AutoModelForSequenceClassification": "bert_layers.BertForSequenceClassification"
  },
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 4096
}


[2024-08-03 17:31:41] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:31:41] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 17:31:41] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 17:31:41] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:00<00:00, 5278.64it/s]
[2024-08-03 17:31:43] (0.0.8alpha) {'avg': 54.359030837004404, 'max': 307, 'min': 23}
[2024-08-03 17:31:43] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:31:43] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 17:31:43] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 17:31:43] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 5067.81it/s]
[2024-08-03 17:31:43] (0.0.8alpha) {'avg': 54.006493506493506, 'max': 216, 'min': 31}
[2024-08-03 17:31:43] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing:   0%|                                          | 0/116 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 70.19it/s]
[2024-08-03 17:31:45] (0.0.8alpha) {'f1_score': 0.26999264564600006, 'matthews_corrcoef': 0.07296732101069797}
Epoch 1/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 1/10 Loss: 0.9765: 100%|██████████████| 1022/1022 [01:09<00:00, 14.80it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.63it/s]
[2024-08-03 17:32:57] (0.0.8alpha) {'f1_score': 0.5973072562517988, 'matthews_corrcoef': 0.2528180326819528}
Epoch 2/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 2/10 Loss: 0.9302: 100%|██████████████| 1022/1022 [01:08<00:00, 14.84it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.52it/s]
[2024-08-03 17:34:08] (0.0.8alpha) {'f1_score': 0.5937753038970436, 'matthews_corrcoef': 0.253099770050946}
Epoch 3/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 3/10 Loss: 0.9191: 100%|██████████████| 1022/1022 [01:09<00:00, 14.80it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.62it/s]
[2024-08-03 17:35:19] (0.0.8alpha) {'f1_score': 0.6136330150288306, 'matthews_corrcoef': 0.26900013746830437}
Epoch 4/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 4/10 Loss: 0.9068: 100%|██████████████| 1022/1022 [01:09<00:00, 14.79it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.47it/s]
[2024-08-03 17:36:31] (0.0.8alpha) {'f1_score': 0.6072543348554839, 'matthews_corrcoef': 0.2637289681224829}
Epoch 5/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 5/10 Loss: 0.8956: 100%|██████████████| 1022/1022 [01:08<00:00, 14.85it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.64it/s]
[2024-08-03 17:37:42] (0.0.8alpha) {'f1_score': 0.633619105442713, 'matthews_corrcoef': 0.2825412068313701}
Epoch 6/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 6/10 Loss: 0.8906: 100%|██████████████| 1022/1022 [01:08<00:00, 14.83it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.87it/s]
[2024-08-03 17:38:54] (0.0.8alpha) {'f1_score': 0.635779234906795, 'matthews_corrcoef': 0.2819992930711026}
Epoch 7/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 7/10 Loss: 0.8854: 100%|██████████████| 1022/1022 [01:08<00:00, 14.89it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.85it/s]
[2024-08-03 17:40:05] (0.0.8alpha) {'f1_score': 0.6345374691143023, 'matthews_corrcoef': 0.2824788355446605}
Epoch 8/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 8/10 Loss: 0.8812: 100%|██████████████| 1022/1022 [01:09<00:00, 14.81it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.88it/s]
[2024-08-03 17:41:16] (0.0.8alpha) {'f1_score': 0.6362796642363521, 'matthews_corrcoef': 0.2835797625595013}
Epoch 9/10 Loss::   0%|                                | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 9/10 Loss: 0.8785: 100%|██████████████| 1022/1022 [01:08<00:00, 14.89it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.74it/s]
[2024-08-03 17:42:27] (0.0.8alpha) {'f1_score': 0.6408823282281916, 'matthews_corrcoef': 0.2880216810017445}
Epoch 10/10 Loss::   0%|                               | 0/1022 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 10/10 Loss: 0.8748: 100%|█████████████| 1022/1022 [01:09<00:00, 14.78it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 69.85it/s]
[2024-08-03 17:43:39] (0.0.8alpha) {'f1_score': 0.6376016899145628, 'matthews_corrcoef': 0.28552769463534494}
Testing:   0%|                                          | 0/116 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 70.16it/s]
[2024-08-03 17:43:41] (0.0.8alpha) {'f1_score': 0.6408823282281916, 'matthews_corrcoef': 0.2880216810017445}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:43:41] (0.0.8alpha) {'valid': [{'f1_score': 0.26999264564600006, 'matthews_corrcoef': 0.07296732101069797}, {'f1_score': 0.5973072562517988, 'matthews_corrcoef': 0.2528180326819528}], 'best_valid': {'f1_score': 0.6408823282281916, 'matthews_corrcoef': 0.2880216810017445}, 'test': [{'f1_score': 0.6408823282281916, 'matthews_corrcoef': 0.2880216810017445}]}

----------------------------------------------------------------------------------- Raw Metric Records -----------------------------------------------------------------------------------
╒═══════════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                           │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-Archive2    │ [0.5573] │  0.5573   │  0.5573  │   0   │   0   │ 0.5573 │ 0.5573 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-rnastralign │ [0.6409] │  0.6409   │  0.6409  │   0   │   0   │ 0.6409 │ 0.6409 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-Archive2    │ [0.2307] │  0.2307   │  0.2307  │   0   │   0   │ 0.2307 │ 0.2307 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-rnastralign │ [0.288]  │   0.288   │  0.288   │   0   │   0   │ 0.288  │ 0.288  │
╘═══════════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
--------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ---------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 17:43:42] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:43:42] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:43:42] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:43:42] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e2cfe0d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e2cfe310>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/DNABERT-2-117M/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
/home/yangheng/.cache/huggingface/modules/transformers_modules/DNABERT-2-117M/bert_layers.py:130: UserWarning: Unable to import Triton; defaulting MosaicBERT attention implementation to pytorch (this will reduce throughput when using this model).
  warnings.warn(
Some weights of BertModel were not initialized from the model checkpoint at genomic_foundation_models/DNABERT-2-117M and are newly initialized: ['bert.pooler.dense.bias', 'bert.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 17:43:42] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/DNABERT-2-117M
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 117.068544 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/DNABERT-2-117M",
  "alibi_starting_size": 512,
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "configuration_bert.BertConfig",
    "AutoModel": "bert_layers.BertModel",
    "AutoModelForMaskedLM": "bert_layers.BertForMaskedLM",
    "AutoModelForSequenceClassification": "bert_layers.BertForSequenceClassification"
  },
  "classifier_dropout": null,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 4096
}


[2024-08-03 17:43:42] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:43:42] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 17:43:42] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 17:43:42] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████| 11304/11304 [00:02<00:00, 4439.61it/s]
[2024-08-03 17:43:48] (0.0.8alpha) {'avg': 77.14614295824487, 'max': 512, 'min': 9}
[2024-08-03 17:43:48] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:43:48] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 17:43:48] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 17:43:48] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 4190.67it/s]
[2024-08-03 17:43:49] (0.0.8alpha) {'avg': 75.02547770700637, 'max': 512, 'min': 11}
[2024-08-03 17:43:49] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing:   0%|                                          | 0/314 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 67.25it/s]
[2024-08-03 17:43:54] (0.0.8alpha) {'f1_score': 0.27536476946885746, 'matthews_corrcoef': 0.10123223950139215}
Epoch 1/10 Loss::   0%|                                | 0/2826 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 1/10 Loss: 1.0306: 100%|██████████████| 2826/2826 [03:12<00:00, 14.68it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 66.97it/s]
[2024-08-03 17:47:13] (0.0.8alpha) {'f1_score': 0.3376629839612, 'matthews_corrcoef': 0.15001268437997006}
Epoch 2/10 Loss::   0%|                                | 0/2826 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 2/10 Loss: 1.0271: 100%|██████████████| 2826/2826 [03:11<00:00, 14.75it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 67.58it/s]
[2024-08-03 17:50:30] (0.0.8alpha) {'f1_score': 0.23633384180478387, 'matthews_corrcoef': 0.0}
Epoch 3/10 Loss::   0%|                                | 0/2826 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 3/10 Loss: 1.0241: 100%|██████████████| 2826/2826 [03:11<00:00, 14.73it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 66.57it/s]
[2024-08-03 17:53:47] (0.0.8alpha) {'f1_score': 0.23633384180478387, 'matthews_corrcoef': 0.0}
Epoch 4/10 Loss::   0%|                                | 0/2826 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Epoch 4/10 Loss: 1.0215: 100%|██████████████| 2826/2826 [03:13<00:00, 14.62it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 66.48it/s]
[2024-08-03 17:57:05] (0.0.8alpha) {'f1_score': 0.23633384180478387, 'matthews_corrcoef': 0.0}
Early stopping at epoch 4.
Testing:   0%|                                          | 0/314 [00:00<?, ?it/s]/home/yangheng/omnigenome/omnigenome/src/abc/abstract_model.py:145: UserWarning: last_hidden_state not found in the outputs from the BertModel model.
  warnings.warn(
Testing: 100%|████████████████████████████████| 314/314 [00:04<00:00, 66.59it/s]
[2024-08-03 17:57:11] (0.0.8alpha) {'f1_score': 0.3376629839612, 'matthews_corrcoef': 0.15001268437997006}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:57:11] (0.0.8alpha) {'valid': [{'f1_score': 0.27536476946885746, 'matthews_corrcoef': 0.10123223950139215}, {'f1_score': 0.3376629839612, 'matthews_corrcoef': 0.15001268437997006}], 'best_valid': {'f1_score': 0.3376629839612, 'matthews_corrcoef': 0.15001268437997006}, 'test': [{'f1_score': 0.3376629839612, 'matthews_corrcoef': 0.15001268437997006}]}

----------------------------------------------------------------------------------- Raw Metric Records -----------------------------------------------------------------------------------
╒═══════════════════╤═════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                           │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-Archive2    │ [0.5573] │  0.5573   │  0.5573  │   0   │   0   │ 0.5573 │ 0.5573 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-rnastralign │ [0.6409] │  0.6409   │  0.6409  │   0   │   0   │ 0.6409 │ 0.6409 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-bpRNA       │ [0.3377] │  0.3377   │  0.3377  │   0   │   0   │ 0.3377 │ 0.3377 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-Archive2    │ [0.2307] │  0.2307   │  0.2307  │   0   │   0   │ 0.2307 │ 0.2307 │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-rnastralign │ [0.288]  │   0.288   │  0.288   │   0   │   0   │ 0.288  │ 0.288  │
├───────────────────┼─────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/DNABERT-2-117M-RNA-SSP-bpRNA       │ [0.15]   │   0.15    │   0.15   │   0   │   0   │  0.15  │  0.15  │
╘═══════════════════╧═════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
--------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ---------------------------------------------------------------------

[2024-08-03 17:57:11] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 17:57:11] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 17:57:11] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: genomic_foundation_models/3utrbert
Tokenizer: None
Device: cuda:0
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-genomic_foundation_models-3utrbert.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 17:57:11] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:57:11] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:57:11] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:57:11] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f856439cee0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f8630d29940>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:57:12] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/3utrbert
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 86.094336 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/3utrbert",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "classifier_dropout": null,
  "eos_token_ids": 0,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_length": 10,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_rnn_layer": 1,
  "output_past": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "rnn": "lstm",
  "rnn_dropout": 0.0,
  "rnn_hidden": 768,
  "split": 10,
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 69
}


[2024-08-03 17:57:12] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:57:12] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 17:57:12] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 17:57:12] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  0%|                                                   | 0/774 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 2833.41it/s]
[2024-08-03 17:57:12] (0.0.8alpha) {'avg': 45.37080103359173, 'max': 169, 'min': 21}
[2024-08-03 17:57:12] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:57:12] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 17:57:12] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 17:57:12] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 3407.05it/s]
[2024-08-03 17:57:12] (0.0.8alpha) {'avg': 47.02173913043478, 'max': 118, 'min': 20}
[2024-08-03 17:57:12] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.15it/s]
[2024-08-03 17:57:12] (0.0.8alpha) {'f1_score': 0.3082849025083781, 'matthews_corrcoef': 0.016412473356314856}
Epoch 1/10 Loss: 1.0456: 100%|████████████████| 194/194 [00:12<00:00, 16.06it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 95.86it/s]
[2024-08-03 17:57:25] (0.0.8alpha) {'f1_score': 0.5006838114471579, 'matthews_corrcoef': 0.10165580938467719}
Epoch 2/10 Loss: 0.9661: 100%|████████████████| 194/194 [00:12<00:00, 16.10it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 99.13it/s]
[2024-08-03 17:57:38] (0.0.8alpha) {'f1_score': 0.5778881477379954, 'matthews_corrcoef': 0.17859873745059476}
Epoch 3/10 Loss: 0.9129: 100%|████████████████| 194/194 [00:10<00:00, 18.32it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.03it/s]
[2024-08-03 17:57:50] (0.0.8alpha) {'f1_score': 0.6265441898180869, 'matthews_corrcoef': 0.20618280010238033}
Epoch 4/10 Loss: 0.8695: 100%|████████████████| 194/194 [00:07<00:00, 25.72it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.27it/s]
[2024-08-03 17:57:58] (0.0.8alpha) {'f1_score': 0.6481599887901907, 'matthews_corrcoef': 0.2139050941509428}
Epoch 5/10 Loss: 0.8483: 100%|████████████████| 194/194 [00:07<00:00, 25.67it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.29it/s]
[2024-08-03 17:58:07] (0.0.8alpha) {'f1_score': 0.654885640055593, 'matthews_corrcoef': 0.20712352181228996}
Epoch 6/10 Loss: 0.8341: 100%|████████████████| 194/194 [00:07<00:00, 25.68it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.43it/s]
[2024-08-03 17:58:16] (0.0.8alpha) {'f1_score': 0.6666906031870262, 'matthews_corrcoef': 0.21258988671104384}
Epoch 7/10 Loss: 0.8237: 100%|████████████████| 194/194 [00:07<00:00, 25.72it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.21it/s]
[2024-08-03 17:58:24] (0.0.8alpha) {'f1_score': 0.6749247666243695, 'matthews_corrcoef': 0.21680150453863634}
Epoch 8/10 Loss: 0.8145: 100%|████████████████| 194/194 [00:07<00:00, 25.79it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.33it/s]
[2024-08-03 17:58:33] (0.0.8alpha) {'f1_score': 0.6745070539103679, 'matthews_corrcoef': 0.21727721475350728}
Epoch 9/10 Loss: 0.8054: 100%|████████████████| 194/194 [00:07<00:00, 25.71it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.09it/s]
[2024-08-03 17:58:40] (0.0.8alpha) {'f1_score': 0.6822414308456852, 'matthews_corrcoef': 0.2242217353766577}
Epoch 10/10 Loss: 0.7974: 100%|███████████████| 194/194 [00:07<00:00, 25.56it/s]
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.18it/s]
[2024-08-03 17:58:49] (0.0.8alpha) {'f1_score': 0.686189755100498, 'matthews_corrcoef': 0.23204920444627372}
Testing: 100%|█████████████████████████████████| 23/23 [00:00<00:00, 103.85it/s]
[2024-08-03 17:58:50] (0.0.8alpha) {'f1_score': 0.686189755100498, 'matthews_corrcoef': 0.23204920444627372}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 17:58:50] (0.0.8alpha) {'valid': [{'f1_score': 0.3082849025083781, 'matthews_corrcoef': 0.016412473356314856}, {'f1_score': 0.5006838114471579, 'matthews_corrcoef': 0.10165580938467719}], 'best_valid': {'f1_score': 0.686189755100498, 'matthews_corrcoef': 0.23204920444627372}, 'test': [{'f1_score': 0.686189755100498, 'matthews_corrcoef': 0.23204920444627372}]}

------------------------------------------------------------------------------- Raw Metric Records -------------------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                  │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-Archive2 │ [0.6862] │  0.6862   │  0.6862  │   0   │   0   │ 0.6862 │ 0.6862 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-Archive2 │ [0.232]  │   0.232   │  0.232   │   0   │   0   │ 0.232  │ 0.232  │
╘═══════════════════╧════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 17:58:50] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 17:58:50] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 17:58:50] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 17:58:50] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e605b280>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e605bdc0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 17:58:51] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/3utrbert
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 86.094336 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/3utrbert",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "classifier_dropout": null,
  "eos_token_ids": 0,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_length": 10,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_rnn_layer": 1,
  "output_past": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "rnn": "lstm",
  "rnn_dropout": 0.0,
  "rnn_hidden": 768,
  "split": 10,
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 69
}


[2024-08-03 17:58:51] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:58:51] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 17:58:51] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 17:58:51] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  0%|                                                  | 0/4086 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
100%|█████████████████████████████████████| 4086/4086 [00:01<00:00, 3893.56it/s]
[2024-08-03 17:58:52] (0.0.8alpha) {'avg': 35.967694566813506, 'max': 169, 'min': 20}
[2024-08-03 17:58:52] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 17:58:52] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 17:58:52] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 17:58:52] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 3943.20it/s]
[2024-08-03 17:58:53] (0.0.8alpha) {'avg': 36.056277056277054, 'max': 164, 'min': 26}
[2024-08-03 17:58:53] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 103.40it/s]
[2024-08-03 17:58:54] (0.0.8alpha) {'f1_score': 0.29738068051165484, 'matthews_corrcoef': 0.004671306073980895}
Epoch 1/10 Loss: 0.8434: 100%|██████████████| 1022/1022 [00:40<00:00, 25.45it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.68it/s]
[2024-08-03 17:59:36] (0.0.8alpha) {'f1_score': 0.7961008827022917, 'matthews_corrcoef': 0.19238832234496006}
Epoch 2/10 Loss: 0.7313: 100%|██████████████| 1022/1022 [00:40<00:00, 25.14it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.52it/s]
[2024-08-03 18:00:18] (0.0.8alpha) {'f1_score': 0.8310915105746867, 'matthews_corrcoef': 0.2077869499974919}
Epoch 3/10 Loss: 0.7057: 100%|██████████████| 1022/1022 [00:40<00:00, 25.40it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.31it/s]
[2024-08-03 18:01:01] (0.0.8alpha) {'f1_score': 0.8394446246336384, 'matthews_corrcoef': 0.2127855160913762}
Epoch 4/10 Loss: 0.6897: 100%|██████████████| 1022/1022 [00:40<00:00, 25.09it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.30it/s]
[2024-08-03 18:01:43] (0.0.8alpha) {'f1_score': 0.8548306998979268, 'matthews_corrcoef': 0.21670772045868997}
Epoch 5/10 Loss: 0.6792: 100%|██████████████| 1022/1022 [00:40<00:00, 25.34it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.80it/s]
[2024-08-03 18:02:26] (0.0.8alpha) {'f1_score': 0.8596406372745538, 'matthews_corrcoef': 0.22060300527505583}
Epoch 6/10 Loss: 0.6708: 100%|██████████████| 1022/1022 [00:40<00:00, 25.40it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.40it/s]
[2024-08-03 18:03:08] (0.0.8alpha) {'f1_score': 0.87097061161205, 'matthews_corrcoef': 0.22383731931333833}
Epoch 7/10 Loss: 0.6648: 100%|██████████████| 1022/1022 [00:40<00:00, 25.30it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.52it/s]
[2024-08-03 18:03:50] (0.0.8alpha) {'f1_score': 0.873817649145124, 'matthews_corrcoef': 0.2257355314531201}
Epoch 8/10 Loss: 0.6594: 100%|██████████████| 1022/1022 [00:41<00:00, 24.91it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.54it/s]
[2024-08-03 18:04:33] (0.0.8alpha) {'f1_score': 0.8783110746202253, 'matthews_corrcoef': 0.2268934040027883}
Epoch 9/10 Loss: 0.6534: 100%|██████████████| 1022/1022 [00:40<00:00, 25.46it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.46it/s]
[2024-08-03 18:05:15] (0.0.8alpha) {'f1_score': 0.8830341043897384, 'matthews_corrcoef': 0.22850562068157154}
Epoch 10/10 Loss: 0.6491: 100%|█████████████| 1022/1022 [00:40<00:00, 25.35it/s]
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.55it/s]
[2024-08-03 18:05:58] (0.0.8alpha) {'f1_score': 0.8855131308640439, 'matthews_corrcoef': 0.22983455889388307}
Testing: 100%|███████████████████████████████| 116/116 [00:01<00:00, 102.74it/s]
[2024-08-03 18:06:00] (0.0.8alpha) {'f1_score': 0.8855131308640439, 'matthews_corrcoef': 0.22983455889388307}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:06:00] (0.0.8alpha) {'valid': [{'f1_score': 0.29738068051165484, 'matthews_corrcoef': 0.004671306073980895}, {'f1_score': 0.7961008827022917, 'matthews_corrcoef': 0.19238832234496006}], 'best_valid': {'f1_score': 0.8855131308640439, 'matthews_corrcoef': 0.22983455889388307}, 'test': [{'f1_score': 0.8855131308640439, 'matthews_corrcoef': 0.22983455889388307}]}

-------------------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                     │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-Archive2    │ [0.6862] │  0.6862   │  0.6862  │   0   │   0   │ 0.6862 │ 0.6862 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-rnastralign │ [0.8855] │  0.8855   │  0.8855  │   0   │   0   │ 0.8855 │ 0.8855 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-Archive2    │ [0.232]  │   0.232   │  0.232   │   0   │   0   │ 0.232  │ 0.232  │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-rnastralign │ [0.2298] │  0.2298   │  0.2298  │   0   │   0   │ 0.2298 │ 0.2298 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 18:06:00] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:06:00] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:06:00] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:06:00] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f8564375670>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85643754c0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:06:00] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/3utrbert
Model Type: bert
Model Architecture: ['BertForMaskedLM']
Model Parameters: 86.094336 M
Model Config: BertConfig {
  "_name_or_path": "genomic_foundation_models/3utrbert",
  "architectures": [
    "BertForMaskedLM"
  ],
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "classifier_dropout": null,
  "eos_token_ids": 0,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "max_length": 10,
  "max_position_embeddings": 512,
  "model_type": "bert",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "num_rnn_layer": 1,
  "output_past": true,
  "pad_token_id": 0,
  "position_embedding_type": "absolute",
  "rnn": "lstm",
  "rnn_dropout": 0.0,
  "rnn_hidden": 768,
  "split": 10,
  "transformers_version": "4.42.0.dev0",
  "type_vocab_size": 2,
  "use_cache": true,
  "vocab_size": 69
}


[2024-08-03 18:06:00] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:06:00] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 18:06:01] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 18:06:01] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  0%|                                                 | 0/11304 [00:00<?, ?it/s]You're using a BertTokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
genomic_foundation_models/3utrbert/omnigenome_wrapper.py:61: UserWarning: Unknown tokens are more than 10% in the 0th sequence, please check the tokenization process.
  warnings.warn(
100%|███████████████████████████████████| 11304/11304 [00:03<00:00, 3315.63it/s]
[2024-08-03 18:06:05] (0.0.8alpha) {'avg': 48.40932413305025, 'max': 512, 'min': 6}
[2024-08-03 18:06:05] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:06:05] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 18:06:05] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 18:06:05] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 3615.60it/s]
[2024-08-03 18:06:06] (0.0.8alpha) {'avg': 46.88136942675159, 'max': 512, 'min': 8}
[2024-08-03 18:06:06] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|███████████████████████████████| 314/314 [00:03<00:00, 102.29it/s]
[2024-08-03 18:06:09] (0.0.8alpha) {'f1_score': 0.30420844219001575, 'matthews_corrcoef': 0.008121508071781653}
Epoch 1/10 Loss: 0.9694: 100%|██████████████| 2826/2826 [01:51<00:00, 25.25it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 106.07it/s]
[2024-08-03 18:08:05] (0.0.8alpha) {'f1_score': 0.4355424459612012, 'matthews_corrcoef': 0.06588789209336174}
Epoch 2/10 Loss: 0.9389: 100%|██████████████| 2826/2826 [01:54<00:00, 24.68it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 106.22it/s]
[2024-08-03 18:10:03] (0.0.8alpha) {'f1_score': 0.4695478699706168, 'matthews_corrcoef': 0.07763306144941763}
Epoch 3/10 Loss: 0.9198: 100%|██████████████| 2826/2826 [01:53<00:00, 24.93it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 105.86it/s]
[2024-08-03 18:12:00] (0.0.8alpha) {'f1_score': 0.5243102706560667, 'matthews_corrcoef': 0.09371771325432952}
Epoch 4/10 Loss: 0.9066: 100%|██████████████| 2826/2826 [01:55<00:00, 24.44it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 104.94it/s]
[2024-08-03 18:14:00] (0.0.8alpha) {'f1_score': 0.5309324821015609, 'matthews_corrcoef': 0.09795620160045465}
Epoch 5/10 Loss: 0.8948: 100%|██████████████| 2826/2826 [02:42<00:00, 17.34it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:03<00:00, 104.46it/s]
[2024-08-03 18:16:47] (0.0.8alpha) {'f1_score': 0.5287357595279963, 'matthews_corrcoef': 0.09677002061497526}
Epoch 6/10 Loss: 0.8858: 100%|██████████████| 2826/2826 [02:48<00:00, 16.79it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 106.86it/s]
[2024-08-03 18:19:38] (0.0.8alpha) {'f1_score': 0.5258534116896475, 'matthews_corrcoef': 0.09750108070275304}
Epoch 7/10 Loss: 0.8778: 100%|██████████████| 2826/2826 [02:48<00:00, 16.76it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 106.62it/s]
[2024-08-03 18:22:30] (0.0.8alpha) {'f1_score': 0.5552280691742494, 'matthews_corrcoef': 0.10556757288140073}
Epoch 8/10 Loss: 0.8707: 100%|██████████████| 2826/2826 [02:47<00:00, 16.84it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 107.60it/s]
[2024-08-03 18:25:22] (0.0.8alpha) {'f1_score': 0.5605383638867535, 'matthews_corrcoef': 0.10921737721335723}
Epoch 9/10 Loss: 0.8643: 100%|██████████████| 2826/2826 [02:47<00:00, 16.86it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:03<00:00, 104.63it/s]
[2024-08-03 18:28:13] (0.0.8alpha) {'f1_score': 0.563253847438277, 'matthews_corrcoef': 0.10528525097020612}
Epoch 10/10 Loss: 0.8582: 100%|█████████████| 2826/2826 [02:52<00:00, 16.40it/s]
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 107.46it/s]
[2024-08-03 18:31:10] (0.0.8alpha) {'f1_score': 0.5789628256344059, 'matthews_corrcoef': 0.11539695373805563}
Testing: 100%|███████████████████████████████| 314/314 [00:02<00:00, 108.07it/s]
[2024-08-03 18:31:14] (0.0.8alpha) {'f1_score': 0.5789628256344059, 'matthews_corrcoef': 0.11539695373805563}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:31:14] (0.0.8alpha) {'valid': [{'f1_score': 0.30420844219001575, 'matthews_corrcoef': 0.008121508071781653}, {'f1_score': 0.4355424459612012, 'matthews_corrcoef': 0.06588789209336174}], 'best_valid': {'f1_score': 0.5789628256344059, 'matthews_corrcoef': 0.11539695373805563}, 'test': [{'f1_score': 0.5789628256344059, 'matthews_corrcoef': 0.11539695373805563}]}

-------------------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                     │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-Archive2    │ [0.6862] │  0.6862   │  0.6862  │   0   │   0   │ 0.6862 │ 0.6862 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-rnastralign │ [0.8855] │  0.8855   │  0.8855  │   0   │   0   │ 0.8855 │ 0.8855 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-bpRNA       │ [0.579]  │   0.579   │  0.579   │   0   │   0   │ 0.579  │ 0.579  │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-Archive2    │ [0.232]  │   0.232   │  0.232   │   0   │   0   │ 0.232  │ 0.232  │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-rnastralign │ [0.2298] │  0.2298   │  0.2298  │   0   │   0   │ 0.2298 │ 0.2298 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/3utrbert-RNA-SSP-bpRNA       │ [0.1154] │  0.1154   │  0.1154  │   0   │   0   │ 0.1154 │ 0.1154 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------------------

[2024-08-03 18:31:14] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 18:31:14] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 18:31:14] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: genomic_foundation_models/hyenadna-large-1m-seqlen-hf
Tokenizer: None
Device: cuda:0
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-genomic_foundation_models-hyenadna-large-1m-seqlen-hf.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 18:31:14] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:31:14] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:31:14] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:31:14] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85457cca60>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f85457ccd30>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:31:14] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/hyenadna-large-1m-seqlen-hf
Model Type: hyenadna
Model Architecture: ['HyenaDNAForCausalLM']
Model Parameters: 46.550608 M
Model Config: HyenaConfig {
  "_name_or_path": "genomic_foundation_models/hyenadna-large-1m-seqlen-hf",
  "activation_freq": 10,
  "architectures": [
    "HyenaDNAForCausalLM"
  ],
  "auto_map": {
    "AutoConfig": "configuration_hyena.HyenaConfig",
    "AutoModel": "modeling_hyena.HyenaDNAModel",
    "AutoModelForCausalLM": "modeling_hyena.HyenaDNAForCausalLM",
    "AutoModelForSequenceClassification": "modeling_hyena.HyenaDNAForSequenceClassification"
  },
  "d_inner": 1024,
  "d_model": 256,
  "emb_dim": 5,
  "embed_dropout": 0.1,
  "filter_order": 64,
  "hidden_size": 256,
  "hyena_dropout": 0.0,
  "hyena_filter_dropout": 0.0,
  "hyena_order": 2,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_epsilon": 1e-05,
  "max_seq_len": 1000002,
  "model_type": "hyenadna",
  "n_layer": 8,
  "num_inner_mlps": 2,
  "pad_token_id": 4,
  "pad_vocab_size_multiple": 8,
  "short_filter_order": 3,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "train_freq": true,
  "transformers_version": "4.42.0.dev0",
  "use_bias": true,
  "vocab_size": 12
}


[2024-08-03 18:31:14] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:31:14] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 18:31:14] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 18:31:14] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 4736.23it/s]
[2024-08-03 18:31:14] (0.0.8alpha) {'avg': 131.14599483204134, 'max': 501, 'min': 59}
[2024-08-03 18:31:14] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:31:14] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 18:31:14] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 18:31:14] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 4794.09it/s]
[2024-08-03 18:31:15] (0.0.8alpha) {'avg': 136.0326086956522, 'max': 349, 'min': 56}
[2024-08-03 18:31:15] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 45.96it/s]
[2024-08-03 18:31:15] (0.0.8alpha) {'f1_score': 0.21244390446242103, 'matthews_corrcoef': 0.014346353291494293}
Epoch 1/10 Loss: 0.9839: 100%|████████████████| 194/194 [00:11<00:00, 16.25it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 83.30it/s]
[2024-08-03 18:31:28] (0.0.8alpha) {'f1_score': 0.5434414251083002, 'matthews_corrcoef': 0.12173570595505583}
Epoch 2/10 Loss: 0.9276: 100%|████████████████| 194/194 [00:11<00:00, 16.19it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 82.55it/s]
[2024-08-03 18:31:40] (0.0.8alpha) {'f1_score': 0.5809348137370596, 'matthews_corrcoef': 0.1505082287188409}
Epoch 3/10 Loss: 0.8879: 100%|████████████████| 194/194 [00:11<00:00, 16.18it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 82.25it/s]
[2024-08-03 18:31:53] (0.0.8alpha) {'f1_score': 0.6065137579554555, 'matthews_corrcoef': 0.1599459620260441}
Epoch 4/10 Loss: 0.8602: 100%|████████████████| 194/194 [00:11<00:00, 16.22it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 83.52it/s]
[2024-08-03 18:32:06] (0.0.8alpha) {'f1_score': 0.6298965504487394, 'matthews_corrcoef': 0.1736116514447563}
Epoch 5/10 Loss: 0.8319: 100%|████████████████| 194/194 [00:11<00:00, 16.23it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 85.14it/s]
[2024-08-03 18:32:19] (0.0.8alpha) {'f1_score': 0.6605292346258191, 'matthews_corrcoef': 0.19702207025259064}
Epoch 6/10 Loss: 0.8076: 100%|████████████████| 194/194 [00:11<00:00, 16.21it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 82.59it/s]
[2024-08-03 18:32:31] (0.0.8alpha) {'f1_score': 0.6673897825271785, 'matthews_corrcoef': 0.19989318199050843}
Epoch 7/10 Loss: 0.7821: 100%|████████████████| 194/194 [00:11<00:00, 16.18it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 80.27it/s]
[2024-08-03 18:32:44] (0.0.8alpha) {'f1_score': 0.6897010971728328, 'matthews_corrcoef': 0.21595319987228176}
Epoch 8/10 Loss: 0.7615: 100%|████████████████| 194/194 [00:12<00:00, 16.06it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 81.30it/s]
[2024-08-03 18:32:57] (0.0.8alpha) {'f1_score': 0.700639397551695, 'matthews_corrcoef': 0.220197782239971}
Epoch 9/10 Loss: 0.7465: 100%|████████████████| 194/194 [00:11<00:00, 16.23it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 80.23it/s]
[2024-08-03 18:33:10] (0.0.8alpha) {'f1_score': 0.6968901719115085, 'matthews_corrcoef': 0.2179875612170937}
Epoch 10/10 Loss: 0.7320: 100%|███████████████| 194/194 [00:12<00:00, 16.13it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 81.01it/s]
[2024-08-03 18:33:22] (0.0.8alpha) {'f1_score': 0.7117532708322029, 'matthews_corrcoef': 0.22372592917669756}
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 89.24it/s]
[2024-08-03 18:33:23] (0.0.8alpha) {'f1_score': 0.7117532708322029, 'matthews_corrcoef': 0.22372592917669756}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:33:23] (0.0.8alpha) {'valid': [{'f1_score': 0.21244390446242103, 'matthews_corrcoef': 0.014346353291494293}, {'f1_score': 0.5434414251083002, 'matthews_corrcoef': 0.12173570595505583}], 'best_valid': {'f1_score': 0.7117532708322029, 'matthews_corrcoef': 0.22372592917669756}, 'test': [{'f1_score': 0.7117532708322029, 'matthews_corrcoef': 0.22372592917669756}]}

---------------------------------------------------------------------------------------- Raw Metric Records ----------------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                                     │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-Archive2 │ [0.7118] │  0.7118   │  0.7118  │   0   │   0   │ 0.7118 │ 0.7118 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-Archive2 │ [0.2237] │  0.2237   │  0.2237  │   0   │   0   │ 0.2237 │ 0.2237 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
-------------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer --------------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 18:33:23] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:33:23] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:33:23] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:33:23] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e6068d30>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e6068ee0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:33:23] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/hyenadna-large-1m-seqlen-hf
Model Type: hyenadna
Model Architecture: ['HyenaDNAForCausalLM']
Model Parameters: 46.550608 M
Model Config: HyenaConfig {
  "_name_or_path": "genomic_foundation_models/hyenadna-large-1m-seqlen-hf",
  "activation_freq": 10,
  "architectures": [
    "HyenaDNAForCausalLM"
  ],
  "auto_map": {
    "AutoConfig": "configuration_hyena.HyenaConfig",
    "AutoModel": "modeling_hyena.HyenaDNAModel",
    "AutoModelForCausalLM": "modeling_hyena.HyenaDNAForCausalLM",
    "AutoModelForSequenceClassification": "modeling_hyena.HyenaDNAForSequenceClassification"
  },
  "d_inner": 1024,
  "d_model": 256,
  "emb_dim": 5,
  "embed_dropout": 0.1,
  "filter_order": 64,
  "hidden_size": 256,
  "hyena_dropout": 0.0,
  "hyena_filter_dropout": 0.0,
  "hyena_order": 2,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_epsilon": 1e-05,
  "max_seq_len": 1000002,
  "model_type": "hyenadna",
  "n_layer": 8,
  "num_inner_mlps": 2,
  "pad_token_id": 4,
  "pad_vocab_size_multiple": 8,
  "short_filter_order": 3,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "train_freq": true,
  "transformers_version": "4.42.0.dev0",
  "use_bias": true,
  "vocab_size": 12
}


[2024-08-03 18:33:23] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:33:23] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 18:33:23] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 18:33:23] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:00<00:00, 4574.05it/s]
[2024-08-03 18:33:25] (0.0.8alpha) {'avg': 102.8957415565345, 'max': 501, 'min': 55}
[2024-08-03 18:33:25] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:33:25] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 18:33:25] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 18:33:25] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 6198.54it/s]
[2024-08-03 18:33:25] (0.0.8alpha) {'avg': 103.2012987012987, 'max': 488, 'min': 72}
[2024-08-03 18:33:25] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 87.10it/s]
[2024-08-03 18:33:27] (0.0.8alpha) {'f1_score': 0.2091692150726999, 'matthews_corrcoef': 0.015064796615048547}
Epoch 1/10 Loss: 0.7655: 100%|██████████████| 1022/1022 [01:04<00:00, 15.94it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 84.03it/s]
[2024-08-03 18:34:33] (0.0.8alpha) {'f1_score': 0.859249639485952, 'matthews_corrcoef': 0.22194541967956546}
Epoch 2/10 Loss: 0.6648: 100%|██████████████| 1022/1022 [01:04<00:00, 15.91it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 83.91it/s]
[2024-08-03 18:35:39] (0.0.8alpha) {'f1_score': 0.8808060555038016, 'matthews_corrcoef': 0.25151753599382176}
Epoch 3/10 Loss: 0.6462: 100%|██████████████| 1022/1022 [01:05<00:00, 15.61it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 84.04it/s]
[2024-08-03 18:36:46] (0.0.8alpha) {'f1_score': 0.8937207029359125, 'matthews_corrcoef': 0.24003769392415494}
Epoch 4/10 Loss: 0.6352: 100%|██████████████| 1022/1022 [01:04<00:00, 15.89it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 83.78it/s]
[2024-08-03 18:37:52] (0.0.8alpha) {'f1_score': 0.8983425138882565, 'matthews_corrcoef': 0.24503427458334848}
Epoch 5/10 Loss: 0.6276: 100%|██████████████| 1022/1022 [01:04<00:00, 15.73it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 83.82it/s]
[2024-08-03 18:38:59] (0.0.8alpha) {'f1_score': 0.9015758433289283, 'matthews_corrcoef': 0.24187787973008607}
Epoch 6/10 Loss: 0.6222: 100%|██████████████| 1022/1022 [01:05<00:00, 15.71it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 84.03it/s]
[2024-08-03 18:40:06] (0.0.8alpha) {'f1_score': 0.9069862029458408, 'matthews_corrcoef': 0.25025489645091414}
Epoch 7/10 Loss: 0.6177: 100%|██████████████| 1022/1022 [01:05<00:00, 15.66it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 83.71it/s]
[2024-08-03 18:41:13] (0.0.8alpha) {'f1_score': 0.9089717784002896, 'matthews_corrcoef': 0.24992026793970448}
Epoch 8/10 Loss: 0.6141: 100%|██████████████| 1022/1022 [01:05<00:00, 15.72it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 83.98it/s]
[2024-08-03 18:42:20] (0.0.8alpha) {'f1_score': 0.9091864013833034, 'matthews_corrcoef': 0.2473509022633264}
Epoch 9/10 Loss: 0.6103: 100%|██████████████| 1022/1022 [01:04<00:00, 15.88it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 83.88it/s]
[2024-08-03 18:43:27] (0.0.8alpha) {'f1_score': 0.9092646827543037, 'matthews_corrcoef': 0.29746651964702053}
Epoch 10/10 Loss: 0.6067: 100%|█████████████| 1022/1022 [01:05<00:00, 15.69it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 84.05it/s]
[2024-08-03 18:44:34] (0.0.8alpha) {'f1_score': 0.9124490375804118, 'matthews_corrcoef': 0.24171986699280673}
Testing: 100%|████████████████████████████████| 116/116 [00:01<00:00, 87.39it/s]
[2024-08-03 18:44:36] (0.0.8alpha) {'f1_score': 0.9124490375804118, 'matthews_corrcoef': 0.24171986699280673}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 18:44:36] (0.0.8alpha) {'valid': [{'f1_score': 0.2091692150726999, 'matthews_corrcoef': 0.015064796615048547}, {'f1_score': 0.859249639485952, 'matthews_corrcoef': 0.22194541967956546}], 'best_valid': {'f1_score': 0.9124490375804118, 'matthews_corrcoef': 0.24171986699280673}, 'test': [{'f1_score': 0.9124490375804118, 'matthews_corrcoef': 0.24171986699280673}]}

------------------------------------------------------------------------------------------ Raw Metric Records ------------------------------------------------------------------------------------------
╒═══════════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                                        │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪══════════════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-Archive2    │ [0.7118] │  0.7118   │  0.7118  │   0   │   0   │ 0.7118 │ 0.7118 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-rnastralign │ [0.9124] │  0.9124   │  0.9124  │   0   │   0   │ 0.9124 │ 0.9124 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-Archive2    │ [0.2237] │  0.2237   │  0.2237  │   0   │   0   │ 0.2237 │ 0.2237 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-rnastralign │ [0.2417] │  0.2417   │  0.2417  │   0   │   0   │ 0.2417 │ 0.2417 │
╘═══════════════════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
--------------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ---------------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 18:44:36] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 18:44:36] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 18:44:36] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 18:44:36] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f8551efce50>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e60689d0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
[2024-08-03 18:44:36] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'Tokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/hyenadna-large-1m-seqlen-hf
Model Type: hyenadna
Model Architecture: ['HyenaDNAForCausalLM']
Model Parameters: 46.550608 M
Model Config: HyenaConfig {
  "_name_or_path": "genomic_foundation_models/hyenadna-large-1m-seqlen-hf",
  "activation_freq": 10,
  "architectures": [
    "HyenaDNAForCausalLM"
  ],
  "auto_map": {
    "AutoConfig": "configuration_hyena.HyenaConfig",
    "AutoModel": "modeling_hyena.HyenaDNAModel",
    "AutoModelForCausalLM": "modeling_hyena.HyenaDNAForCausalLM",
    "AutoModelForSequenceClassification": "modeling_hyena.HyenaDNAForSequenceClassification"
  },
  "d_inner": 1024,
  "d_model": 256,
  "emb_dim": 5,
  "embed_dropout": 0.1,
  "filter_order": 64,
  "hidden_size": 256,
  "hyena_dropout": 0.0,
  "hyena_filter_dropout": 0.0,
  "hyena_order": 2,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_epsilon": 1e-05,
  "max_seq_len": 1000002,
  "model_type": "hyenadna",
  "n_layer": 8,
  "num_inner_mlps": 2,
  "pad_token_id": 4,
  "pad_vocab_size_multiple": 8,
  "short_filter_order": 3,
  "tie_word_embeddings": false,
  "torch_dtype": "float32",
  "train_freq": true,
  "transformers_version": "4.42.0.dev0",
  "use_bias": true,
  "vocab_size": 12
}


[2024-08-03 18:44:36] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:44:36] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 18:44:36] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 18:44:36] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
  8%|██▉                                  | 895/11304 [00:00<00:02, 4506.64it/s]genomic_foundation_models/hyenadna-large-1m-seqlen-hf/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.21428571428571427% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
genomic_foundation_models/hyenadna-large-1m-seqlen-hf/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.10909090909090909% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
 80%|████████████████████████████▉       | 9090/11304 [00:01<00:00, 4999.77it/s]genomic_foundation_models/hyenadna-large-1m-seqlen-hf/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.14285714285714285% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
 85%|██████████████████████████████▋     | 9631/11304 [00:01<00:00, 5119.29it/s]genomic_foundation_models/hyenadna-large-1m-seqlen-hf/omnigenome_wrapper.py:56: UserWarning: Unknown tokens are more than 0.10526315789473684% in the 0-th sequence, please check the tokenization process.
  warnings.warn(
100%|███████████████████████████████████| 11304/11304 [00:02<00:00, 5029.92it/s]
[2024-08-03 18:44:41] (0.0.8alpha) {'avg': 134.37039985845718, 'max': 512, 'min': 13}
[2024-08-03 18:44:41] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 18:44:41] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 18:44:41] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 18:44:41] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 5109.06it/s]
[2024-08-03 18:44:41] (0.0.8alpha) {'avg': 132.0485668789809, 'max': 512, 'min': 19}
[2024-08-03 18:44:41] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.86it/s]
[2024-08-03 18:44:45] (0.0.8alpha) {'f1_score': 0.24973688740984992, 'matthews_corrcoef': 0.025404026597250547}
Epoch 1/10 Loss: 0.9579: 100%|██████████████| 2826/2826 [03:01<00:00, 15.60it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.73it/s]
[2024-08-03 18:47:50] (0.0.8alpha) {'f1_score': 0.4525809915666487, 'matthews_corrcoef': 0.05235338087279947}
Epoch 2/10 Loss: 0.9402: 100%|██████████████| 2826/2826 [03:02<00:00, 15.47it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.65it/s]
[2024-08-03 18:50:57] (0.0.8alpha) {'f1_score': 0.41598582965520164, 'matthews_corrcoef': 0.07724729448497823}
Epoch 3/10 Loss: 0.9252: 100%|██████████████| 2826/2826 [03:02<00:00, 15.46it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.93it/s]
[2024-08-03 18:54:03] (0.0.8alpha) {'f1_score': 0.5116476836662868, 'matthews_corrcoef': 0.08465211451689238}
Epoch 4/10 Loss: 0.9104: 100%|██████████████| 2826/2826 [03:02<00:00, 15.45it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.63it/s]
[2024-08-03 18:57:11] (0.0.8alpha) {'f1_score': 0.539667204883206, 'matthews_corrcoef': 0.0904009146083594}
Epoch 5/10 Loss: 0.8951: 100%|██████████████| 2826/2826 [03:02<00:00, 15.46it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.83it/s]
[2024-08-03 19:00:18] (0.0.8alpha) {'f1_score': 0.5200323137005217, 'matthews_corrcoef': 0.1040121609687318}
Epoch 6/10 Loss: 0.8799: 100%|██████████████| 2826/2826 [02:57<00:00, 15.88it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 88.54it/s]
[2024-08-03 19:03:19] (0.0.8alpha) {'f1_score': 0.5459549888384063, 'matthews_corrcoef': 0.10229528127649884}
Epoch 7/10 Loss: 0.8654: 100%|██████████████| 2826/2826 [02:58<00:00, 15.81it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 85.93it/s]
[2024-08-03 19:06:22] (0.0.8alpha) {'f1_score': 0.5502007381308557, 'matthews_corrcoef': 0.10968683512457393}
Epoch 8/10 Loss: 0.8513: 100%|██████████████| 2826/2826 [02:56<00:00, 16.03it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 89.17it/s]
[2024-08-03 19:09:23] (0.0.8alpha) {'f1_score': 0.5611045915167353, 'matthews_corrcoef': 0.10844042289886173}
Epoch 9/10 Loss: 0.8389: 100%|██████████████| 2826/2826 [02:56<00:00, 16.01it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 89.70it/s]
[2024-08-03 19:12:23] (0.0.8alpha) {'f1_score': 0.5637545655191153, 'matthews_corrcoef': 0.11198728329316344}
Epoch 10/10 Loss: 0.8269: 100%|█████████████| 2826/2826 [02:55<00:00, 16.12it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 89.21it/s]
[2024-08-03 19:15:23] (0.0.8alpha) {'f1_score': 0.5743139169920956, 'matthews_corrcoef': 0.10834728705679401}
Testing: 100%|████████████████████████████████| 314/314 [00:03<00:00, 89.21it/s]
[2024-08-03 19:15:27] (0.0.8alpha) {'f1_score': 0.5743139169920956, 'matthews_corrcoef': 0.10834728705679401}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 19:15:27] (0.0.8alpha) {'valid': [{'f1_score': 0.24973688740984992, 'matthews_corrcoef': 0.025404026597250547}, {'f1_score': 0.4525809915666487, 'matthews_corrcoef': 0.05235338087279947}], 'best_valid': {'f1_score': 0.5743139169920956, 'matthews_corrcoef': 0.10834728705679401}, 'test': [{'f1_score': 0.5743139169920956, 'matthews_corrcoef': 0.10834728705679401}]}

------------------------------------------------------------------------------------------ Raw Metric Records ------------------------------------------------------------------------------------------
╒═══════════════════╤══════════════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                                        │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪══════════════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-Archive2    │ [0.7118] │  0.7118   │  0.7118  │   0   │   0   │ 0.7118 │ 0.7118 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-rnastralign │ [0.9124] │  0.9124   │  0.9124  │   0   │   0   │ 0.9124 │ 0.9124 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-bpRNA       │ [0.5743] │  0.5743   │  0.5743  │   0   │   0   │ 0.5743 │ 0.5743 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-Archive2    │ [0.2237] │  0.2237   │  0.2237  │   0   │   0   │ 0.2237 │ 0.2237 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-rnastralign │ [0.2417] │  0.2417   │  0.2417  │   0   │   0   │ 0.2417 │ 0.2417 │
├───────────────────┼──────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/hyenadna-large-1m-seqlen-hf-RNA-SSP-bpRNA       │ [0.1083] │  0.1083   │  0.1083  │   0   │   0   │ 0.1083 │ 0.1083 │
╘═══════════════════╧══════════════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
--------------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ---------------------------------------------------------------------------

[2024-08-03 19:15:27] (0.0.8alpha) Benchmark: RGB does not exist. Search online for available benchmarks.
[2024-08-03 19:15:27] (0.0.8alpha) Loaded benchmarks:  ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
[2024-08-03 19:15:27] (0.0.8alpha) Benchmark Root: __OMNIGENOME_DATA__/benchmarks/RGB
Benchmark List: ['RNA-SSP-Archive2', 'RNA-SSP-rnastralign', 'RNA-SSP-bpRNA']
Model Name or Path: genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species
Tokenizer: None
Device: cuda:0
Metric Visualizer Path: __OMNIGENOME_DATA__-benchmarks-RGB-genomic_foundation_models-nucleotide-transformer-v2-100m-multi-species.mv
BenchConfig Details: <module 'bench_metadata' from '__OMNIGENOME_DATA__/benchmarks/RGB/metadata.py'>

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/config.py>
[2024-08-03 19:15:27] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 19:15:27] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 19:15:27] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 19:15:27] (0.0.8alpha) AutoBench Config for RNA-SSP-Archive2: task_name: RNA-SSP-Archive2
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f8630d29940>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f84e2cecd30>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
Some weights of EsmModel were not initialized from the model checkpoint at genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species and are newly initialized: ['esm.pooler.dense.bias', 'esm.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 19:15:28] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species
Model Type: esm
Model Architecture: ['EsmForMaskedLM', 'EsmForTokenClassification', 'EsmForSequenceClassification']
Model Parameters: 95.781217 M
Model Config: EsmConfig {
  "_name_or_path": "genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species",
  "add_bias_fnn": false,
  "architectures": [
    "EsmForMaskedLM",
    "EsmForTokenClassification",
    "EsmForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "esm_config.EsmConfig",
    "AutoModel": "modeling_esm.EsmModel",
    "AutoModelForMaskedLM": "modeling_esm.EsmForMaskedLM",
    "AutoModelForSequenceClassification": "modeling_esm.EsmForSequenceClassification",
    "AutoModelForTokenClassification": "modeling_esm.EsmForTokenClassification"
  },
  "emb_layer_norm_before": false,
  "esmfold_config": null,
  "hidden_dropout_prob": 0.0,
  "hidden_size": 512,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "is_folding_model": false,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "mask_token_id": 2,
  "max_position_embeddings": 2050,
  "model_type": "esm",
  "num_attention_heads": 16,
  "num_hidden_layers": 22,
  "pad_token_id": 1,
  "position_embedding_type": "rotary",
  "tie_word_embeddings": false,
  "token_dropout": false,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "use_cache": false,
  "vocab_list": null,
  "vocab_size": 4107
}


[2024-08-03 19:15:28] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:15:28] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json...
[2024-08-03 19:15:28] (0.0.8alpha) Loaded 774 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/train.json
[2024-08-03 19:15:28] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 774/774 [00:00<00:00, 3178.50it/s]
[2024-08-03 19:15:29] (0.0.8alpha) {'avg': 84.07105943152455, 'max': 348, 'min': 34}
[2024-08-03 19:15:29] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:15:29] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json...
[2024-08-03 19:15:29] (0.0.8alpha) Loaded 92 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-Archive2/test.json
[2024-08-03 19:15:29] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████████| 92/92 [00:00<00:00, 2890.78it/s]
[2024-08-03 19:15:29] (0.0.8alpha) {'avg': 85.77173913043478, 'max': 219, 'min': 35}
[2024-08-03 19:15:29] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 42.21it/s]
[2024-08-03 19:15:29] (0.0.8alpha) {'f1_score': 0.32006712049904734, 'matthews_corrcoef': -0.01351365508358448}
Epoch 1/10 Loss: 0.9849: 100%|████████████████| 194/194 [00:16<00:00, 11.54it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 42.88it/s]
[2024-08-03 19:15:47] (0.0.8alpha) {'f1_score': 0.5624205745873222, 'matthews_corrcoef': 0.15903830596160728}
Epoch 2/10 Loss: 0.8941: 100%|████████████████| 194/194 [00:16<00:00, 11.56it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 43.10it/s]
[2024-08-03 19:16:06] (0.0.8alpha) {'f1_score': 0.6247321157433606, 'matthews_corrcoef': 0.16973380335721225}
Epoch 3/10 Loss: 0.8561: 100%|████████████████| 194/194 [00:16<00:00, 11.55it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 42.84it/s]
[2024-08-03 19:16:24] (0.0.8alpha) {'f1_score': 0.6332668803504113, 'matthews_corrcoef': 0.1788022074006997}
Epoch 4/10 Loss: 0.8406: 100%|████████████████| 194/194 [00:16<00:00, 11.54it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 42.97it/s]
[2024-08-03 19:16:42] (0.0.8alpha) {'f1_score': 0.6480697951221764, 'matthews_corrcoef': 0.18261148762598992}
Epoch 5/10 Loss: 0.8217: 100%|████████████████| 194/194 [00:16<00:00, 11.58it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 43.01it/s]
[2024-08-03 19:17:00] (0.0.8alpha) {'f1_score': 0.6631130849062389, 'matthews_corrcoef': 0.19506463722947343}
Epoch 6/10 Loss: 0.8047: 100%|████████████████| 194/194 [00:16<00:00, 11.56it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 42.98it/s]
[2024-08-03 19:17:18] (0.0.8alpha) {'f1_score': 0.6592735791037989, 'matthews_corrcoef': 0.18755591658540416}
Epoch 7/10 Loss: 0.7925: 100%|████████████████| 194/194 [00:16<00:00, 11.56it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 42.95it/s]
[2024-08-03 19:17:36] (0.0.8alpha) {'f1_score': 0.6647605925110364, 'matthews_corrcoef': 0.19172358853045393}
Epoch 8/10 Loss: 0.7787: 100%|████████████████| 194/194 [00:16<00:00, 11.55it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 43.04it/s]
[2024-08-03 19:17:54] (0.0.8alpha) {'f1_score': 0.6688588549054968, 'matthews_corrcoef': 0.2008161400203279}
Epoch 9/10 Loss: 0.7661: 100%|████████████████| 194/194 [00:16<00:00, 11.56it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 43.08it/s]
[2024-08-03 19:18:12] (0.0.8alpha) {'f1_score': 0.6777794372685997, 'matthews_corrcoef': 0.2002212694458915}
Epoch 10/10 Loss: 0.7548: 100%|███████████████| 194/194 [00:16<00:00, 11.56it/s]
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 43.07it/s]
[2024-08-03 19:18:30] (0.0.8alpha) {'f1_score': 0.683595000022723, 'matthews_corrcoef': 0.2037287142442921}
Testing: 100%|██████████████████████████████████| 23/23 [00:00<00:00, 43.15it/s]
[2024-08-03 19:18:32] (0.0.8alpha) {'f1_score': 0.683595000022723, 'matthews_corrcoef': 0.2037287142442921}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 19:18:32] (0.0.8alpha) {'valid': [{'f1_score': 0.32006712049904734, 'matthews_corrcoef': -0.01351365508358448}, {'f1_score': 0.5624205745873222, 'matthews_corrcoef': 0.15903830596160728}], 'best_valid': {'f1_score': 0.683595000022723, 'matthews_corrcoef': 0.2037287142442921}, 'test': [{'f1_score': 0.683595000022723, 'matthews_corrcoef': 0.2037287142442921}]}

------------------------------------------------------------------------------------------------- Raw Metric Records -------------------------------------------------------------------------------------------------
╒═══════════════════╤════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                                                      │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-Archive2 │ [0.6836] │  0.6836   │  0.6836  │   0   │   0   │ 0.6836 │ 0.6836 │
├───────────────────┼────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-Archive2 │ [0.2037] │  0.2037   │  0.2037  │   0   │   0   │ 0.2037 │ 0.2037 │
╘═══════════════════╧════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
---------------------------------------------------------------------------------- https://github.com/yangheng95/metric_visualizer ----------------------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/config.py>
[2024-08-03 19:18:32] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 19:18:32] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 19:18:32] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 19:18:32] (0.0.8alpha) AutoBench Config for RNA-SSP-rnastralign: task_name: RNA-SSP-rnastralign
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f849bb88c10>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f849bb88b80>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
Some weights of EsmModel were not initialized from the model checkpoint at genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species and are newly initialized: ['esm.pooler.dense.bias', 'esm.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 19:18:33] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species
Model Type: esm
Model Architecture: ['EsmForMaskedLM', 'EsmForTokenClassification', 'EsmForSequenceClassification']
Model Parameters: 95.781217 M
Model Config: EsmConfig {
  "_name_or_path": "genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species",
  "add_bias_fnn": false,
  "architectures": [
    "EsmForMaskedLM",
    "EsmForTokenClassification",
    "EsmForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "esm_config.EsmConfig",
    "AutoModel": "modeling_esm.EsmModel",
    "AutoModelForMaskedLM": "modeling_esm.EsmForMaskedLM",
    "AutoModelForSequenceClassification": "modeling_esm.EsmForSequenceClassification",
    "AutoModelForTokenClassification": "modeling_esm.EsmForTokenClassification"
  },
  "emb_layer_norm_before": false,
  "esmfold_config": null,
  "hidden_dropout_prob": 0.0,
  "hidden_size": 512,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "is_folding_model": false,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "mask_token_id": 2,
  "max_position_embeddings": 2050,
  "model_type": "esm",
  "num_attention_heads": 16,
  "num_hidden_layers": 22,
  "pad_token_id": 1,
  "position_embedding_type": "rotary",
  "tie_word_embeddings": false,
  "token_dropout": false,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "use_cache": false,
  "vocab_list": null,
  "vocab_size": 4107
}


[2024-08-03 19:18:33] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:18:33] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json...
[2024-08-03 19:18:33] (0.0.8alpha) Loaded 4086 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/train.json
[2024-08-03 19:18:33] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 4086/4086 [00:01<00:00, 3854.76it/s]
[2024-08-03 19:18:35] (0.0.8alpha) {'avg': 66.12555066079295, 'max': 348, 'min': 20}
[2024-08-03 19:18:35] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:18:35] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json...
[2024-08-03 19:18:35] (0.0.8alpha) Loaded 462 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-rnastralign/test.json
[2024-08-03 19:18:35] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████████| 462/462 [00:00<00:00, 3806.20it/s]
[2024-08-03 19:18:35] (0.0.8alpha) {'avg': 66.18181818181819, 'max': 247, 'min': 30}
[2024-08-03 19:18:35] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 42.38it/s]
[2024-08-03 19:18:38] (0.0.8alpha) {'f1_score': 0.3164023120594779, 'matthews_corrcoef': -0.015833890238353354}
Epoch 1/10 Loss: 0.8039: 100%|██████████████| 1022/1022 [01:29<00:00, 11.40it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 42.26it/s]
[2024-08-03 19:20:11] (0.0.8alpha) {'f1_score': 0.7700007200388465, 'matthews_corrcoef': 0.18890807460670744}
Epoch 2/10 Loss: 0.7463: 100%|██████████████| 1022/1022 [01:29<00:00, 11.38it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 42.58it/s]
[2024-08-03 19:21:45] (0.0.8alpha) {'f1_score': 0.7961387512654277, 'matthews_corrcoef': 0.20975092605566187}
Epoch 3/10 Loss: 0.7260: 100%|██████████████| 1022/1022 [01:31<00:00, 11.14it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 42.05it/s]
[2024-08-03 19:23:20] (0.0.8alpha) {'f1_score': 0.8119580213723966, 'matthews_corrcoef': 0.20762385899390845}
Epoch 4/10 Loss: 0.7105: 100%|██████████████| 1022/1022 [01:30<00:00, 11.23it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.68it/s]
[2024-08-03 19:24:55] (0.0.8alpha) {'f1_score': 0.8116919500628894, 'matthews_corrcoef': 0.2075410552952267}
Epoch 5/10 Loss: 0.6960: 100%|██████████████| 1022/1022 [01:30<00:00, 11.25it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.64it/s]
[2024-08-03 19:26:29] (0.0.8alpha) {'f1_score': 0.8197959746242516, 'matthews_corrcoef': 0.21082735537236066}
Epoch 6/10 Loss: 0.6843: 100%|██████████████| 1022/1022 [01:31<00:00, 11.23it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.72it/s]
[2024-08-03 19:28:03] (0.0.8alpha) {'f1_score': 0.8257124680690687, 'matthews_corrcoef': 0.2125968711749116}
Epoch 7/10 Loss: 0.6758: 100%|██████████████| 1022/1022 [01:31<00:00, 11.22it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.68it/s]
[2024-08-03 19:29:38] (0.0.8alpha) {'f1_score': 0.828514696355421, 'matthews_corrcoef': 0.21468574636322704}
Epoch 8/10 Loss: 0.6668: 100%|██████████████| 1022/1022 [01:30<00:00, 11.24it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.70it/s]
[2024-08-03 19:31:13] (0.0.8alpha) {'f1_score': 0.8299395046842362, 'matthews_corrcoef': 0.21637954051841396}
Epoch 9/10 Loss: 0.6587: 100%|██████████████| 1022/1022 [01:30<00:00, 11.29it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.62it/s]
[2024-08-03 19:32:47] (0.0.8alpha) {'f1_score': 0.83183092471682, 'matthews_corrcoef': 0.21598781985672763}
Epoch 10/10 Loss: 0.6517: 100%|█████████████| 1022/1022 [01:30<00:00, 11.27it/s]
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.62it/s]
[2024-08-03 19:34:22] (0.0.8alpha) {'f1_score': 0.8267728339161925, 'matthews_corrcoef': 0.21424498386299956}
Testing: 100%|████████████████████████████████| 116/116 [00:02<00:00, 41.73it/s]
[2024-08-03 19:34:25] (0.0.8alpha) {'f1_score': 0.83183092471682, 'matthews_corrcoef': 0.21598781985672763}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 19:34:25] (0.0.8alpha) {'valid': [{'f1_score': 0.3164023120594779, 'matthews_corrcoef': -0.015833890238353354}, {'f1_score': 0.7700007200388465, 'matthews_corrcoef': 0.18890807460670744}], 'best_valid': {'f1_score': 0.83183092471682, 'matthews_corrcoef': 0.21598781985672763}, 'test': [{'f1_score': 0.83183092471682, 'matthews_corrcoef': 0.21598781985672763}]}

-------------------------------------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                                                         │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-Archive2    │ [0.6836] │  0.6836   │  0.6836  │   0   │   0   │ 0.6836 │ 0.6836 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-rnastralign │ [0.8318] │  0.8318   │  0.8318  │   0   │   0   │ 0.8318 │ 0.8318 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-Archive2    │ [0.2037] │  0.2037   │  0.2037  │   0   │   0   │ 0.2037 │ 0.2037 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-rnastralign │ [0.216]  │   0.216   │  0.216   │   0   │   0   │ 0.216  │ 0.216  │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------------------------------------

FindFile Warning --> multiple targets ['__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA-2000-90/__pycache__/config.cpython-39.pyc', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py', '__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/__pycache__/config.cpython-39.pyc'] found, only return the shortest path: <__OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/config.py>
[2024-08-03 19:34:25] (0.0.8alpha) Override batch_size with 4 according to the input kwargs
[2024-08-03 19:34:25] (0.0.8alpha) Override max_length with 512 according to the input kwargs
/home/yangheng/omnigenome/omnigenome/bench/auto_bench/auto_bench.py:108: UserWarning: kwarg: patience not found in benchconfig while setting patience = 3
  warnings.warn(f"kwarg: {key} not found in benchconfig while setting {key} = {value}" )
[2024-08-03 19:34:25] (0.0.8alpha) Override seeds with [3407] according to the input kwargs
[2024-08-03 19:34:25] (0.0.8alpha) AutoBench Config for RNA-SSP-bpRNA: task_name: RNA-SSP-bpRNA
task_type: token_classification
label2id: {'(': 0, ')': 1, '.': 2}
num_labels: None
epochs: 10
learning_rate: 2e-05
weight_decay: 1e-05
batch_size: 4
max_length: 512
seeds: [3407]
compute_metrics: [<function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f849bb880d0>, <function ClassificationMetric.__getattribute__.<locals>.wrapper at 0x7f849bb881f0>]
train_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
test_file: __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
valid_file: None
dataset_cls: <class 'OmniGenome.OmniGenomeDatasetForTokenClassification'>
model_cls: <class 'omnigenome.src.model.classiifcation.model.OmniGenomeModelForTokenClassification'>
patience: 3
/home/yangheng/omnigenome/omnigenome/src/abc/abstract_tokenizer.py:39: UserWarning: Cannot find the tokenizer wrapper from genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species/omnigenome_wrapper.py, using the default OmniGenomeTokenizer.
  warnings.warn(
Some weights of EsmModel were not initialized from the model checkpoint at genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species and are newly initialized: ['esm.pooler.dense.bias', 'esm.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
[2024-08-03 19:34:26] (0.0.8alpha) Model Name: OmniGenomeModelForTokenClassification
Model Metadata: {'library_name': 'OmniGenome', 'omnigenome_version': '0.0.8alpha', 'torch_version': '2.1.2+cu12.1+gita8e7c98cb95ff97bb30a728c6b2a1ce6bff946eb', 'transformers_version': '4.42.0.dev0', 'model_cls': 'OmniGenomeModelForTokenClassification', 'tokenizer_cls': 'OmniGenomeTokenizer', 'model_name': 'OmniGenomeModelForTokenClassification'}
Base Model Name: genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species
Model Type: esm
Model Architecture: ['EsmForMaskedLM', 'EsmForTokenClassification', 'EsmForSequenceClassification']
Model Parameters: 95.781217 M
Model Config: EsmConfig {
  "_name_or_path": "genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species",
  "add_bias_fnn": false,
  "architectures": [
    "EsmForMaskedLM",
    "EsmForTokenClassification",
    "EsmForSequenceClassification"
  ],
  "attention_probs_dropout_prob": 0.0,
  "auto_map": {
    "AutoConfig": "esm_config.EsmConfig",
    "AutoModel": "modeling_esm.EsmModel",
    "AutoModelForMaskedLM": "modeling_esm.EsmForMaskedLM",
    "AutoModelForSequenceClassification": "modeling_esm.EsmForSequenceClassification",
    "AutoModelForTokenClassification": "modeling_esm.EsmForTokenClassification"
  },
  "emb_layer_norm_before": false,
  "esmfold_config": null,
  "hidden_dropout_prob": 0.0,
  "hidden_size": 512,
  "id2label": {
    "0": "(",
    "1": ")",
    "2": "."
  },
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "is_folding_model": false,
  "label2id": {
    "(": 0,
    ")": 1,
    ".": 2
  },
  "layer_norm_eps": 1e-12,
  "mask_token_id": 2,
  "max_position_embeddings": 2050,
  "model_type": "esm",
  "num_attention_heads": 16,
  "num_hidden_layers": 22,
  "pad_token_id": 1,
  "position_embedding_type": "rotary",
  "tie_word_embeddings": false,
  "token_dropout": false,
  "torch_dtype": "float32",
  "transformers_version": "4.42.0.dev0",
  "use_cache": false,
  "vocab_list": null,
  "vocab_size": 4107
}


[2024-08-03 19:34:26] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:34:26] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json...
[2024-08-03 19:34:26] (0.0.8alpha) Loaded 11304 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/train.json
[2024-08-03 19:34:26] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|███████████████████████████████████| 11304/11304 [00:04<00:00, 2819.02it/s]
[2024-08-03 19:34:32] (0.0.8alpha) {'avg': 89.30599787685775, 'max': 512, 'min': 6}
[2024-08-03 19:34:32] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
[2024-08-03 19:34:32] (0.0.8alpha) Loading data from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json...
[2024-08-03 19:34:32] (0.0.8alpha) Loaded 1256 examples from __OMNIGENOME_DATA__/benchmarks/RGB/RNA-SSP-bpRNA/test.json
[2024-08-03 19:34:32] (0.0.8alpha) Detected shuffle=True, shuffling the examples...
100%|█████████████████████████████████████| 1256/1256 [00:00<00:00, 3054.20it/s]
[2024-08-03 19:34:33] (0.0.8alpha) {'avg': 87.45541401273886, 'max': 512, 'min': 13}
[2024-08-03 19:34:33] (0.0.8alpha) Detected max_length=512 in the dataset, using it as the max_length.
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.53it/s]
[2024-08-03 19:34:41] (0.0.8alpha) {'f1_score': 0.3178999766293002, 'matthews_corrcoef': -0.03116498246359929}
Epoch 1/10 Loss: 0.9666: 100%|██████████████| 2826/2826 [04:14<00:00, 11.09it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.65it/s]
[2024-08-03 19:39:04] (0.0.8alpha) {'f1_score': 0.4236624307178036, 'matthews_corrcoef': 0.06366703731202952}
Epoch 2/10 Loss: 0.9410: 100%|██████████████| 2826/2826 [04:13<00:00, 11.14it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 42.12it/s]
[2024-08-03 19:43:27] (0.0.8alpha) {'f1_score': 0.40967281470432293, 'matthews_corrcoef': 0.06623804301460116}
Epoch 3/10 Loss: 0.9209: 100%|██████████████| 2826/2826 [04:13<00:00, 11.14it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.98it/s]
[2024-08-03 19:47:48] (0.0.8alpha) {'f1_score': 0.5158980001504503, 'matthews_corrcoef': 0.09129442840797587}
Epoch 4/10 Loss: 0.9007: 100%|██████████████| 2826/2826 [04:14<00:00, 11.11it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 42.05it/s]
[2024-08-03 19:52:11] (0.0.8alpha) {'f1_score': 0.5280541422974611, 'matthews_corrcoef': 0.10660457385422402}
Epoch 5/10 Loss: 0.8793: 100%|██████████████| 2826/2826 [04:15<00:00, 11.06it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.70it/s]
[2024-08-03 19:56:35] (0.0.8alpha) {'f1_score': 0.5325722718109674, 'matthews_corrcoef': 0.1055931174043955}
Epoch 6/10 Loss: 0.8590: 100%|██████████████| 2826/2826 [04:14<00:00, 11.12it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.69it/s]
[2024-08-03 20:00:58] (0.0.8alpha) {'f1_score': 0.5372218247088181, 'matthews_corrcoef': 0.09778044732006352}
Epoch 7/10 Loss: 0.8401: 100%|██████████████| 2826/2826 [04:15<00:00, 11.08it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.70it/s]
[2024-08-03 20:05:22] (0.0.8alpha) {'f1_score': 0.5625062798796748, 'matthews_corrcoef': 0.1117724499607665}
Epoch 8/10 Loss: 0.8225: 100%|██████████████| 2826/2826 [04:15<00:00, 11.05it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 42.16it/s]
[2024-08-03 20:09:46] (0.0.8alpha) {'f1_score': 0.5694985970181845, 'matthews_corrcoef': 0.10889826118379563}
Epoch 9/10 Loss: 0.8080: 100%|██████████████| 2826/2826 [04:11<00:00, 11.22it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 42.25it/s]
[2024-08-03 20:14:06] (0.0.8alpha) {'f1_score': 0.5686075929059706, 'matthews_corrcoef': 0.10761210358537937}
Epoch 10/10 Loss: 0.7946: 100%|█████████████| 2826/2826 [04:13<00:00, 11.15it/s]
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.71it/s]
[2024-08-03 20:18:27] (0.0.8alpha) {'f1_score': 0.5685068019405735, 'matthews_corrcoef': 0.10589061407829717}
Testing: 100%|████████████████████████████████| 314/314 [00:07<00:00, 41.74it/s]
[2024-08-03 20:18:35] (0.0.8alpha) {'f1_score': 0.5694985970181845, 'matthews_corrcoef': 0.10889826118379563}
/home/yangheng/miniconda3/lib/python3.9/site-packages/metric_visualizer/utils.py:31: RuntimeWarning: Precision loss occurred in moment calculation due to catastrophic cancellation. This occurs when the data are nearly identical. Results may be unreliable.
  self.skewness = stats.skew(self.data, keepdims=True)
[2024-08-03 20:18:35] (0.0.8alpha) {'valid': [{'f1_score': 0.3178999766293002, 'matthews_corrcoef': -0.03116498246359929}, {'f1_score': 0.4236624307178036, 'matthews_corrcoef': 0.06366703731202952}], 'best_valid': {'f1_score': 0.5694985970181845, 'matthews_corrcoef': 0.10889826118379563}, 'test': [{'f1_score': 0.5694985970181845, 'matthews_corrcoef': 0.10889826118379563}]}

-------------------------------------------------------------------------------------------------- Raw Metric Records --------------------------------------------------------------------------------------------------
╒═══════════════════╤═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╤══════════╤═══════════╤══════════╤═══════╤═══════╤════════╤════════╕
│ Metric            │ Trial                                                                                                                         │ Values   │  Average  │  Median  │  Std  │  IQR  │  Min   │  Max   │
╞═══════════════════╪═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╪══════════╪═══════════╪══════════╪═══════╪═══════╪════════╪════════╡
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-Archive2    │ [0.6836] │  0.6836   │  0.6836  │   0   │   0   │ 0.6836 │ 0.6836 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-rnastralign │ [0.8318] │  0.8318   │  0.8318  │   0   │   0   │ 0.8318 │ 0.8318 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ f1_score          │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-bpRNA       │ [0.5695] │  0.5695   │  0.5695  │   0   │   0   │ 0.5695 │ 0.5695 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-Archive2    │ [0.2037] │  0.2037   │  0.2037  │   0   │   0   │ 0.2037 │ 0.2037 │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-rnastralign │ [0.216]  │   0.216   │  0.216   │   0   │   0   │ 0.216  │ 0.216  │
├───────────────────┼───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┼──────────┼───────────┼──────────┼───────┼───────┼────────┼────────┤
│ matthews_corrcoef │ __OMNIGENOME_DATA__/benchmarks/RGB-genomic_foundation_models/nucleotide-transformer-v2-100m-multi-species-RNA-SSP-bpRNA       │ [0.1089] │  0.1089   │  0.1089  │   0   │   0   │ 0.1089 │ 0.1089 │
╘═══════════════════╧═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╧══════════╧═══════════╧══════════╧═══════╧═══════╧════════╧════════╛
------------------------------------------------------------------------------------ https://github.com/yangheng95/metric_visualizer ------------------------------------------------------------------------------------

/home/yangheng/miniconda3/lib/python3.9/tempfile.py:821: ResourceWarning: Implicitly cleaning up <TemporaryDirectory '/home/yangheng/omnigenome/examples/benchmark/tmp_qyue_ic'>
  _warnings.warn(warn_message, ResourceWarning)

Process finished with exit code 0
